[0m20:52:02.290930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c95350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cafe50>]}


============================== 20:52:02.297272 | f3c96872-48f9-45ee-bedd-f2fd18bda944 ==============================
[0m20:52:02.297272 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m20:52:02.297997 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/oliverzheng/.dbt', 'introspect': 'True', 'invocation_command': 'dbt init build_mau', 'write_json': 'True', 'empty': 'None', 'partial_parse': 'True', 'no_print': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True'}
[0m20:52:02.334939 [debug] [MainThread]: Starter project path: /Users/oliverzheng/anaconda3/lib/python3.11/site-packages/dbt/include/starter_project
[0m20:52:02.346214 [info ] [MainThread]: 
Your new dbt project "build_mau" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m20:52:02.346843 [info ] [MainThread]: Setting up your profile.
[0m20:56:55.689259 [info ] [MainThread]: Profile build_mau written to /Users/oliverzheng/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m20:56:55.759418 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 293.5489, "process_in_blocks": "0", "process_kernel_time": 1.212576, "process_mem_max_rss": "162938880", "process_out_blocks": "0", "process_user_time": 3.183236}
[0m20:56:55.764303 [debug] [MainThread]: Command `dbt init` succeeded at 20:56:55.763685 after 293.56 seconds
[0m20:56:55.769872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109874610>]}
[0m20:56:55.774966 [debug] [MainThread]: Flushing usage events
[0m20:56:56.395960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:28.487061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc582d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcba350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccff90>]}


============================== 21:30:28.493644 | 44c8fce0-c0de-41c4-b2da-9fea6166b592 ==============================
[0m21:30:28.493644 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m21:30:28.494414 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/oliverzheng/Desktop/Airflow/dbt', 'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'log_format': 'default', 'fail_fast': 'False'}
[0m21:30:28.500902 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m21:30:28.510816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.12922364, "process_in_blocks": "0", "process_kernel_time": 0.465776, "process_mem_max_rss": "96313344", "process_out_blocks": "0", "process_user_time": 1.697573}
[0m21:30:28.512151 [debug] [MainThread]: Command `dbt run` failed at 21:30:28.511792 after 0.13 seconds
[0m21:30:28.512749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc95250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcb9210>]}
[0m21:30:28.513295 [debug] [MainThread]: Flushing usage events
[0m21:30:28.986285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:56.121561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7c4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f837ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f59ecd0>]}


============================== 21:58:56.129060 | e5546625-ac94-464a-b4a2-a5610a214430 ==============================
[0m21:58:56.129060 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m21:58:56.129884 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '/Users/oliverzheng/Desktop/Airflow/dbt', 'use_colors': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'no_print': 'None', 'target_path': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'write_json': 'True'}
[0m21:58:56.137675 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m21:58:56.141970 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11655678, "process_in_blocks": "0", "process_kernel_time": 0.411501, "process_mem_max_rss": "96440320", "process_out_blocks": "0", "process_user_time": 1.732781}
[0m21:58:56.142924 [debug] [MainThread]: Command `dbt run` failed at 21:58:56.142761 after 0.12 seconds
[0m21:58:56.143472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f837f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f837f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8bff50>]}
[0m21:58:56.144023 [debug] [MainThread]: Flushing usage events
[0m21:58:56.707678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:55.956116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0c2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c087050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0effd0>]}


============================== 22:15:55.963846 | 49d5dd37-03c3-4999-aa76-fe3f3f7e2625 ==============================
[0m22:15:55.963846 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:15:55.964648 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '.', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True'}
[0m22:15:55.973025 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_TYPE'
[0m22:15:55.976837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11475753, "process_in_blocks": "0", "process_kernel_time": 0.421761, "process_mem_max_rss": "96251904", "process_out_blocks": "0", "process_user_time": 1.678917}
[0m22:15:55.977656 [debug] [MainThread]: Command `dbt run` failed at 22:15:55.977518 after 0.12 seconds
[0m22:15:55.978154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c114510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c075910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108143fd0>]}
[0m22:15:55.978628 [debug] [MainThread]: Flushing usage events
[0m22:15:56.492067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:19.266790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138bc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138bd210>]}


============================== 22:16:19.275918 | 44dd5e90-155b-4c66-a0b7-ff48885ff038 ==============================
[0m22:16:19.275918 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:16:19.276955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'no_print': 'None', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'version_check': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False'}
[0m22:16:30.959823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44dd5e90-155b-4c66-a0b7-ff48885ff038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fda4310>]}
[0m22:16:31.026342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44dd5e90-155b-4c66-a0b7-ff48885ff038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe51950>]}
[0m22:16:31.027861 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:16:31.298525 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:16:31.300128 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:16:31.300668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44dd5e90-155b-4c66-a0b7-ff48885ff038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe18050>]}
[0m22:16:32.682354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44dd5e90-155b-4c66-a0b7-ff48885ff038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140347d90>]}
[0m22:16:32.753858 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m22:16:32.757421 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m22:16:32.783008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44dd5e90-155b-4c66-a0b7-ff48885ff038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140587450>]}
[0m22:16:32.783760 [info ] [MainThread]: Found 1 model, 1 source, 496 macros
[0m22:16:32.784294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44dd5e90-155b-4c66-a0b7-ff48885ff038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13feba390>]}
[0m22:16:32.786042 [info ] [MainThread]: 
[0m22:16:32.786607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:16:32.787012 [info ] [MainThread]: 
[0m22:16:32.787651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:32.788655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m22:16:32.938820 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m22:16:32.939469 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m22:16:32.939977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:34.911251 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.969 seconds
[0m22:16:34.915167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m22:16:34.930848 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m22:16:34.931337 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m22:16:35.114636 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.183 seconds
[0m22:16:35.121692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44dd5e90-155b-4c66-a0b7-ff48885ff038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140073a10>]}
[0m22:16:35.127982 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m22:16:35.128875 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m22:16:35.129611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now model.stock_transformations.stg_stock_prices)
[0m22:16:35.130223 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m22:16:35.140360 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m22:16:35.141678 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m22:16:35.182213 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m22:16:35.184603 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m22:16:35.185318 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null and date is not null and close is not null
),
dedup as (
  select *
  from (
    select *, row_number() over (partition by symbol, dt order by dt desc) as rn
    from src
  )
  where rn = 1
)

select symbol, dt, open, high, low, close, volume
from dedup
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */;
[0m22:16:35.354856 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c09978-0307-1cd8-000f-c0df0090257a
[0m22:16:35.355885 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 32 at position 169 unexpected ';'.
[0m22:16:35.362757 [debug] [Thread-1 (]: Database Error in model stg_stock_prices (models/stg_stock_prices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 169 unexpected ';'.
  compiled code at target/run/stock_transformations/models/stg_stock_prices.sql
[0m22:16:35.365782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44dd5e90-155b-4c66-a0b7-ff48885ff038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1407ca510>]}
[0m22:16:35.366852 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.stg_stock_prices ................ [[31mERROR[0m in 0.23s]
[0m22:16:35.367830 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m22:16:35.368642 [debug] [Thread-4 (]: Marking all children of 'model.stock_transformations.stg_stock_prices' to be skipped because of status 'error'.  Reason: Database Error in model stg_stock_prices (models/stg_stock_prices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 169 unexpected ';'.
  compiled code at target/run/stock_transformations/models/stg_stock_prices.sql.
[0m22:16:35.370236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:35.370861 [debug] [MainThread]: Connection 'model.stock_transformations.stg_stock_prices' was left open.
[0m22:16:35.371436 [debug] [MainThread]: On model.stock_transformations.stg_stock_prices: Close
[0m22:16:35.536727 [info ] [MainThread]: 
[0m22:16:35.537504 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m22:16:35.538559 [debug] [MainThread]: Command end result
[0m22:16:35.564706 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m22:16:35.566619 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m22:16:35.573230 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m22:16:35.573776 [info ] [MainThread]: 
[0m22:16:35.574268 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:16:35.574665 [info ] [MainThread]: 
[0m22:16:35.575707 [error] [MainThread]: [31mFailure in model stg_stock_prices (models/stg_stock_prices.sql)[0m
[0m22:16:35.577299 [error] [MainThread]:   Database Error in model stg_stock_prices (models/stg_stock_prices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 32 at position 169 unexpected ';'.
  compiled code at target/run/stock_transformations/models/stg_stock_prices.sql
[0m22:16:35.578074 [info ] [MainThread]: 
[0m22:16:35.578619 [info ] [MainThread]:   compiled code at target/compiled/stock_transformations/models/stg_stock_prices.sql
[0m22:16:35.579019 [info ] [MainThread]: 
[0m22:16:35.579453 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:16:35.586564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.388195, "process_in_blocks": "0", "process_kernel_time": 1.462538, "process_mem_max_rss": "199524352", "process_out_blocks": "0", "process_user_time": 5.71697}
[0m22:16:35.587302 [debug] [MainThread]: Command `dbt run` failed at 22:16:35.587176 after 16.39 seconds
[0m22:16:35.587783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138abb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138abe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f924110>]}
[0m22:16:35.588222 [debug] [MainThread]: Flushing usage events
[0m22:16:35.972566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:19:12.823232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11467f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11467d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114687fd0>]}


============================== 22:19:12.830285 | d1409a4a-aef7-4dfb-8576-bcc73de11143 ==============================
[0m22:19:12.830285 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:19:12.831104 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'empty': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt run'}
[0m22:19:14.875893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1409a4a-aef7-4dfb-8576-bcc73de11143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140b6f210>]}
[0m22:19:14.955082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1409a4a-aef7-4dfb-8576-bcc73de11143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140bc9a10>]}
[0m22:19:14.956296 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:19:15.172287 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:19:15.353564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:19:15.354493 [debug] [MainThread]: Partial parsing: updated file: stock_transformations://models/stg_stock_prices.sql
[0m22:19:15.777062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1409a4a-aef7-4dfb-8576-bcc73de11143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f06710>]}
[0m22:19:15.860314 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m22:19:15.862729 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m22:19:15.889317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1409a4a-aef7-4dfb-8576-bcc73de11143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a78650>]}
[0m22:19:15.889998 [info ] [MainThread]: Found 1 model, 1 source, 496 macros
[0m22:19:15.890472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1409a4a-aef7-4dfb-8576-bcc73de11143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1409e5310>]}
[0m22:19:15.892175 [info ] [MainThread]: 
[0m22:19:15.893057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:19:15.893481 [info ] [MainThread]: 
[0m22:19:15.894080 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:19:15.895033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m22:19:16.036213 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m22:19:16.036748 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m22:19:16.037147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:17.325285 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.288 seconds
[0m22:19:17.330065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m22:19:17.348052 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m22:19:17.348606 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m22:19:17.586610 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.237 seconds
[0m22:19:17.593274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1409a4a-aef7-4dfb-8576-bcc73de11143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14105ba50>]}
[0m22:19:17.598782 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m22:19:17.599866 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m22:19:17.600739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now model.stock_transformations.stg_stock_prices)
[0m22:19:17.601434 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m22:19:17.611250 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m22:19:17.612283 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m22:19:17.645878 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m22:19:17.647537 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m22:19:17.648013 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */;
[0m22:19:18.086439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.438 seconds
[0m22:19:18.122868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1409a4a-aef7-4dfb-8576-bcc73de11143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114660f90>]}
[0m22:19:18.124019 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 0.52s]
[0m22:19:18.124932 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m22:19:18.126398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:18.126870 [debug] [MainThread]: Connection 'model.stock_transformations.stg_stock_prices' was left open.
[0m22:19:18.127281 [debug] [MainThread]: On model.stock_transformations.stg_stock_prices: Close
[0m22:19:18.262963 [info ] [MainThread]: 
[0m22:19:18.264137 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m22:19:18.265536 [debug] [MainThread]: Command end result
[0m22:19:18.294828 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m22:19:18.296631 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m22:19:18.304824 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m22:19:18.305417 [info ] [MainThread]: 
[0m22:19:18.306079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:19:18.306532 [info ] [MainThread]: 
[0m22:19:18.307011 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:19:18.313330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.577032, "process_in_blocks": "0", "process_kernel_time": 1.24927, "process_mem_max_rss": "193609728", "process_out_blocks": "0", "process_user_time": 4.527173}
[0m22:19:18.314108 [debug] [MainThread]: Command `dbt run` succeeded at 22:19:18.313970 after 5.58 seconds
[0m22:19:18.314605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114685c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146876d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ef590>]}
[0m22:19:18.315088 [debug] [MainThread]: Flushing usage events
[0m22:19:18.872194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:52.007031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c00490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c01110>]}


============================== 22:40:52.015679 | 4a04a3f6-c261-45d9-8b16-cc62671eba18 ==============================
[0m22:40:52.015679 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:40:52.016674 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '.', 'empty': 'False', 'target_path': 'None'}
[0m22:40:54.236749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a04a3f6-c261-45d9-8b16-cc62671eba18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7f850>]}
[0m22:40:54.306705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a04a3f6-c261-45d9-8b16-cc62671eba18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809a950>]}
[0m22:40:54.308487 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:40:54.495919 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:40:54.660670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:40:54.661317 [debug] [MainThread]: Partial parsing: added file: stock_transformations://models/fct_stock_abstract.sql
[0m22:40:55.064977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a04a3f6-c261-45d9-8b16-cc62671eba18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135397f50>]}
[0m22:40:55.149452 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m22:40:55.152000 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m22:40:55.179613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a04a3f6-c261-45d9-8b16-cc62671eba18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1353ed110>]}
[0m22:40:55.180289 [info ] [MainThread]: Found 2 models, 1 source, 496 macros
[0m22:40:55.180765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a04a3f6-c261-45d9-8b16-cc62671eba18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1355aab90>]}
[0m22:40:55.182385 [info ] [MainThread]: 
[0m22:40:55.182819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:40:55.183176 [info ] [MainThread]: 
[0m22:40:55.183720 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:40:55.188416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m22:40:55.343259 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m22:40:55.343852 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m22:40:55.344308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:56.592937 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.248 seconds
[0m22:40:56.599938 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m22:40:56.600725 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m22:40:56.734999 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.134 seconds
[0m22:40:56.738881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now create_USER_DB_BOA_analytics_ANALYTICS)
[0m22:40:56.739877 [debug] [ThreadPool]: Creating schema "database: "USER_DB_BOA"
schema: "analytics_ANALYTICS"
"
[0m22:40:56.746695 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_BOA_analytics_ANALYTICS"
[0m22:40:56.747217 [debug] [ThreadPool]: On create_USER_DB_BOA_analytics_ANALYTICS: create schema if not exists USER_DB_BOA.analytics_ANALYTICS
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "create_USER_DB_BOA_analytics_ANALYTICS"} */
[0m22:40:56.913156 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.165 seconds
[0m22:40:56.916678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_BOA_analytics_ANALYTICS, now list_USER_DB_BOA_analytics_ANALYTICS)
[0m22:40:56.935289 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics_ANALYTICS"
[0m22:40:56.935848 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics_ANALYTICS: show objects in USER_DB_BOA.analytics_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics_ANALYTICS"} */;
[0m22:40:57.080879 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.144 seconds
[0m22:40:57.084418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics_ANALYTICS, now list_USER_DB_BOA_analytics)
[0m22:40:57.088705 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m22:40:57.089287 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m22:40:57.322050 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.232 seconds
[0m22:40:57.329014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a04a3f6-c261-45d9-8b16-cc62671eba18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13590bc50>]}
[0m22:40:57.334356 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m22:40:57.335493 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m22:40:57.336300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now model.stock_transformations.stg_stock_prices)
[0m22:40:57.336940 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m22:40:57.347633 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m22:40:57.348650 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m22:40:57.386501 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m22:40:57.388123 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m22:40:57.388595 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */;
[0m22:40:57.754589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m22:40:57.787208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a04a3f6-c261-45d9-8b16-cc62671eba18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13512a410>]}
[0m22:40:57.788258 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 0.45s]
[0m22:40:57.789060 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m22:40:57.789922 [debug] [Thread-1 (]: Began running node model.stock_transformations.fct_stock_abstract
[0m22:40:57.790531 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_ANALYTICS.STOCK_ABSTRACT ................ [RUN]
[0m22:40:57.791091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_transformations.stg_stock_prices, now model.stock_transformations.fct_stock_abstract)
[0m22:40:57.791544 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.fct_stock_abstract
[0m22:40:57.795137 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.fct_stock_abstract"
[0m22:40:57.795912 [debug] [Thread-1 (]: Began executing node model.stock_transformations.fct_stock_abstract
[0m22:40:57.823187 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.fct_stock_abstract"
[0m22:40:57.825587 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.fct_stock_abstract"
[0m22:40:57.826197 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: create or replace transient table USER_DB_BOA.analytics_ANALYTICS.STOCK_ABSTRACT
    
    
    
    as (

with base as (
  select
    symbol, dt, open, high, low, close, volume,
    lag(close) over (partition by symbol order by dt) as prev_close
  from USER_DB_BOA.analytics.stg_stock_prices
),
deltas as (
  select
    *,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
ma as (
  select
    *,
    avg(close) over (partition by symbol order by dt rows between 6 preceding  and current row) as sma_7,
    avg(close) over (partition by symbol order by dt rows between 13 preceding and current row) as sma_14,
    avg(close) over (partition by symbol order by dt rows between 29 preceding and current row) as sma_30
  from deltas
),
rsi as (
  select
    *,
    avg(gain) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_gain_14,
    avg(loss) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_loss_14
  from ma
)
select
  symbol, dt, open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  case when avg_loss_14 = 0 then 100
       else 100 - 100 / (1 + (avg_gain_14 / nullif(avg_loss_14,0)))
  end as rsi_14,
  (close / nullif(lag(close, 7) over (partition by symbol order by dt), 0)) - 1 as momentum_7d
from rsi
order by symbol, dt
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.fct_stock_abstract"} */;
[0m22:40:59.574719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.748 seconds
[0m22:40:59.578101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a04a3f6-c261-45d9-8b16-cc62671eba18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135162cd0>]}
[0m22:40:59.578911 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_ANALYTICS.STOCK_ABSTRACT ........... [[32mSUCCESS 1[0m in 1.79s]
[0m22:40:59.579894 [debug] [Thread-1 (]: Finished running node model.stock_transformations.fct_stock_abstract
[0m22:40:59.581380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:59.581833 [debug] [MainThread]: Connection 'model.stock_transformations.fct_stock_abstract' was left open.
[0m22:40:59.582257 [debug] [MainThread]: On model.stock_transformations.fct_stock_abstract: Close
[0m22:40:59.726845 [info ] [MainThread]: 
[0m22:40:59.727546 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m22:40:59.728558 [debug] [MainThread]: Command end result
[0m22:40:59.754549 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m22:40:59.756386 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m22:40:59.763242 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m22:40:59.763738 [info ] [MainThread]: 
[0m22:40:59.764351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:59.765289 [info ] [MainThread]: 
[0m22:40:59.767058 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:40:59.775550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8616757, "process_in_blocks": "0", "process_kernel_time": 1.246051, "process_mem_max_rss": "200675328", "process_out_blocks": "0", "process_user_time": 4.593716}
[0m22:40:59.776317 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:59.776192 after 7.86 seconds
[0m22:40:59.776805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c00890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c01090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c57590>]}
[0m22:40:59.777263 [debug] [MainThread]: Flushing usage events
[0m22:41:00.432033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:52.629309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f6dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c75ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c83410>]}


============================== 22:56:52.639211 | dd8d601e-2af4-485d-bb45-30ab333b9a3d ==============================
[0m22:56:52.639211 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:56:52.640180 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_colors': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'target_path': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '.', 'static_parser': 'True'}
[0m22:56:54.801904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd8d601e-2af4-485d-bb45-30ab333b9a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131fdcfd0>]}
[0m22:56:54.869826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd8d601e-2af4-485d-bb45-30ab333b9a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132183d50>]}
[0m22:56:54.871589 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:56:55.058350 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:56:55.219795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:56:55.221001 [debug] [MainThread]: Partial parsing: updated file: stock_transformations://models/fct_stock_abstract.sql
[0m22:56:55.630170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd8d601e-2af4-485d-bb45-30ab333b9a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f7d850>]}
[0m22:56:55.707307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m22:56:55.710867 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m22:56:55.737935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd8d601e-2af4-485d-bb45-30ab333b9a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132096850>]}
[0m22:56:55.738601 [info ] [MainThread]: Found 2 models, 1 source, 496 macros
[0m22:56:55.739180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd8d601e-2af4-485d-bb45-30ab333b9a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1324056d0>]}
[0m22:56:55.741047 [info ] [MainThread]: 
[0m22:56:55.741577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:56:55.741976 [info ] [MainThread]: 
[0m22:56:55.742557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:56:55.747014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m22:56:55.895093 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m22:56:55.895580 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m22:56:55.896075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:57.178362 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.282 seconds
[0m22:56:57.183090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m22:56:57.199934 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m22:56:57.200480 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m22:56:57.324352 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.123 seconds
[0m22:56:57.330751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd8d601e-2af4-485d-bb45-30ab333b9a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6ff90>]}
[0m22:56:57.336267 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m22:56:57.337250 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m22:56:57.338079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now model.stock_transformations.stg_stock_prices)
[0m22:56:57.338721 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m22:56:57.348420 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m22:56:57.349758 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m22:56:57.391205 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m22:56:57.393146 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m22:56:57.393780 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */;
[0m22:56:57.769886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m22:56:57.803075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd8d601e-2af4-485d-bb45-30ab333b9a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13222a050>]}
[0m22:56:57.804189 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 0.46s]
[0m22:56:57.804993 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m22:56:57.805910 [debug] [Thread-1 (]: Began running node model.stock_transformations.fct_stock_abstract
[0m22:56:57.806556 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.STOCK_ABSTRACT .......................... [RUN]
[0m22:56:57.807139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_transformations.stg_stock_prices, now model.stock_transformations.fct_stock_abstract)
[0m22:56:57.807608 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.fct_stock_abstract
[0m22:56:57.811217 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.fct_stock_abstract"
[0m22:56:57.812092 [debug] [Thread-1 (]: Began executing node model.stock_transformations.fct_stock_abstract
[0m22:56:57.841090 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.fct_stock_abstract"
[0m22:56:57.844668 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.fct_stock_abstract"
[0m22:56:57.845347 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: create or replace transient table USER_DB_BOA.analytics.STOCK_ABSTRACT
    
    
    
    as (

with base as (
  select
    symbol, dt, open, high, low, close, volume,
    lag(close) over (partition by symbol order by dt) as prev_close
  from USER_DB_BOA.analytics.stg_stock_prices
),
deltas as (
  select
    *,
    greatest(close - prev_close, 0) as gain,
    greatest(prev_close - close, 0) as loss
  from base
),
ma as (
  select
    *,
    avg(close) over (partition by symbol order by dt rows between 6 preceding  and current row) as sma_7,
    avg(close) over (partition by symbol order by dt rows between 13 preceding and current row) as sma_14,
    avg(close) over (partition by symbol order by dt rows between 29 preceding and current row) as sma_30
  from deltas
),
rsi as (
  select
    *,
    avg(gain) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_gain_14,
    avg(loss) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_loss_14
  from ma
)
select
  symbol, dt, open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  case when avg_loss_14 = 0 then 100
       else 100 - 100 / (1 + (avg_gain_14 / nullif(avg_loss_14,0)))
  end as rsi_14,
  (close / nullif(lag(close, 7) over (partition by symbol order by dt), 0)) - 1 as momentum_7d
from rsi
order by symbol, dt
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.fct_stock_abstract"} */;
[0m22:56:58.705153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m22:56:58.710872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd8d601e-2af4-485d-bb45-30ab333b9a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132270cd0>]}
[0m22:56:58.712189 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.STOCK_ABSTRACT ..................... [[32mSUCCESS 1[0m in 0.90s]
[0m22:56:58.713166 [debug] [Thread-1 (]: Finished running node model.stock_transformations.fct_stock_abstract
[0m22:56:58.714895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:58.715451 [debug] [MainThread]: Connection 'model.stock_transformations.fct_stock_abstract' was left open.
[0m22:56:58.716000 [debug] [MainThread]: On model.stock_transformations.fct_stock_abstract: Close
[0m22:56:58.858562 [info ] [MainThread]: 
[0m22:56:58.859160 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m22:56:58.860252 [debug] [MainThread]: Command end result
[0m22:56:58.887925 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m22:56:58.890136 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m22:56:58.900073 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m22:56:58.900930 [info ] [MainThread]: 
[0m22:56:58.902008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:58.902783 [info ] [MainThread]: 
[0m22:56:58.903662 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m22:56:58.913971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.373493, "process_in_blocks": "0", "process_kernel_time": 1.23997, "process_mem_max_rss": "197885952", "process_out_blocks": "0", "process_user_time": 4.484733}
[0m22:56:58.915331 [debug] [MainThread]: Command `dbt run` succeeded at 22:56:58.915136 after 6.38 seconds
[0m22:56:58.915996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ce7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cf8150>]}
[0m22:56:58.916668 [debug] [MainThread]: Flushing usage events
[0m22:56:59.357963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:55.507137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110325050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103a0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103a0f90>]}


============================== 23:01:55.517158 | d6b9ce18-9bfa-4ad8-b24f-908400aefe77 ==============================
[0m23:01:55.517158 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:01:55.518158 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'version_check': 'True', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'profiles_dir': '.', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run'}
[0m23:01:57.667786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b9ce18-9bfa-4ad8-b24f-908400aefe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c2b710>]}
[0m23:01:57.736040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b9ce18-9bfa-4ad8-b24f-908400aefe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c7cd810>]}
[0m23:01:57.737750 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:01:57.919320 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:01:58.077276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:01:58.077959 [debug] [MainThread]: Partial parsing: updated file: stock_transformations://models/fct_stock_abstract.sql
[0m23:01:58.468341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b9ce18-9bfa-4ad8-b24f-908400aefe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115004610>]}
[0m23:01:58.546192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:01:58.549765 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:01:58.577266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b9ce18-9bfa-4ad8-b24f-908400aefe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cd73850>]}
[0m23:01:58.577895 [info ] [MainThread]: Found 2 models, 1 source, 496 macros
[0m23:01:58.578338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b9ce18-9bfa-4ad8-b24f-908400aefe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cb93ed0>]}
[0m23:01:58.579771 [info ] [MainThread]: 
[0m23:01:58.580208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:01:58.580588 [info ] [MainThread]: 
[0m23:01:58.581156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:01:58.585740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m23:01:58.748989 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m23:01:58.749476 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m23:01:58.749863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:59.906835 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.157 seconds
[0m23:01:59.910005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m23:01:59.925131 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m23:01:59.925639 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m23:02:00.063465 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.137 seconds
[0m23:02:00.070552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b9ce18-9bfa-4ad8-b24f-908400aefe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c7cca50>]}
[0m23:02:00.075089 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m23:02:00.075975 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m23:02:00.076781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now model.stock_transformations.stg_stock_prices)
[0m23:02:00.077427 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m23:02:00.087320 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m23:02:00.088890 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m23:02:00.126307 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m23:02:00.128009 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m23:02:00.128482 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */;
[0m23:02:00.664412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m23:02:00.696820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b9ce18-9bfa-4ad8-b24f-908400aefe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c719110>]}
[0m23:02:00.697894 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 0.62s]
[0m23:02:00.698622 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m23:02:00.699469 [debug] [Thread-1 (]: Began running node model.stock_transformations.fct_stock_abstract
[0m23:02:00.700100 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.STOCK_INDICATORS ........................ [RUN]
[0m23:02:00.700650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_transformations.stg_stock_prices, now model.stock_transformations.fct_stock_abstract)
[0m23:02:00.701104 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.fct_stock_abstract
[0m23:02:00.704524 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.fct_stock_abstract"
[0m23:02:00.705783 [debug] [Thread-1 (]: Began executing node model.stock_transformations.fct_stock_abstract
[0m23:02:00.736253 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.fct_stock_abstract"
[0m23:02:00.740431 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.fct_stock_abstract"
[0m23:02:00.741138 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: create or replace transient table USER_DB_BOA.analytics.STOCK_INDICATORS
    
    
    
    as (

with base as (
  select
    symbol,
    dt,
    open, high, low, close, volume,
    row_number() over (partition by symbol order by dt) as rn,
    lag(close) over (partition by symbol order by dt) as prev_close
  from USER_DB_BOA.analytics.stg_stock_prices
),
deltas as (
  select
    *,
    iff(prev_close is null, null, greatest(close - prev_close, 0)) as gain,
    iff(prev_close is null, null, greatest(prev_close - close, 0)) as loss
  from base
),
ma as (
  select
    *,
    avg(close) over (partition by symbol order by dt rows between 6  preceding and current row) as sma_7,
    avg(close) over (partition by symbol order by dt rows between 13 preceding and current row) as sma_14,
    avg(close) over (partition by symbol order by dt rows between 29 preceding and current row) as sma_30,
    lag(close, 7) over (partition by symbol order by dt) as close_7
  from deltas
),
rsi as (
  select
    *,
    avg(gain) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_gain_14,
    avg(loss) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_loss_14
  from ma
)
select
  symbol, dt, open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  case
    when avg_gain_14 is null or avg_loss_14 is null then null
    when avg_loss_14 = 0 then 100
    when avg_gain_14 = 0 then 0
    else 100 - 100 / (1 + (avg_gain_14 / avg_loss_14))
  end as rsi_14,
  iff(close_7 is null, null, (close / nullif(close_7, 0)) - 1) as momentum_7d
from rsi
-- require enough history so all indicators are defined: max window = 30
qualify rn > 30
order by symbol, dt
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.fct_stock_abstract"} */;
[0m23:02:00.858116 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c099a6-0307-1c18-000f-c0df00904512
[0m23:02:00.859180 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 53 at position 171 unexpected ';'.
[0m23:02:00.866852 [debug] [Thread-1 (]: Database Error in model fct_stock_abstract (models/fct_stock_abstract.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 171 unexpected ';'.
  compiled code at target/run/stock_transformations/models/fct_stock_abstract.sql
[0m23:02:00.868001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b9ce18-9bfa-4ad8-b24f-908400aefe77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d923ad0>]}
[0m23:02:00.869212 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model analytics.STOCK_INDICATORS ............... [[31mERROR[0m in 0.17s]
[0m23:02:00.870201 [debug] [Thread-1 (]: Finished running node model.stock_transformations.fct_stock_abstract
[0m23:02:00.871077 [debug] [Thread-4 (]: Marking all children of 'model.stock_transformations.fct_stock_abstract' to be skipped because of status 'error'.  Reason: Database Error in model fct_stock_abstract (models/fct_stock_abstract.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 171 unexpected ';'.
  compiled code at target/run/stock_transformations/models/fct_stock_abstract.sql.
[0m23:02:00.872808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:00.873386 [debug] [MainThread]: Connection 'model.stock_transformations.fct_stock_abstract' was left open.
[0m23:02:00.873914 [debug] [MainThread]: On model.stock_transformations.fct_stock_abstract: Close
[0m23:02:01.018051 [info ] [MainThread]: 
[0m23:02:01.019165 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m23:02:01.020845 [debug] [MainThread]: Command end result
[0m23:02:01.051709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:02:01.053677 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:02:01.062099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:02:01.062637 [info ] [MainThread]: 
[0m23:02:01.063425 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:02:01.064220 [info ] [MainThread]: 
[0m23:02:01.065077 [error] [MainThread]: [31mFailure in model fct_stock_abstract (models/fct_stock_abstract.sql)[0m
[0m23:02:01.066874 [error] [MainThread]:   Database Error in model fct_stock_abstract (models/fct_stock_abstract.sql)
  001003 (42000): SQL compilation error:
  syntax error line 53 at position 171 unexpected ';'.
  compiled code at target/run/stock_transformations/models/fct_stock_abstract.sql
[0m23:02:01.067735 [info ] [MainThread]: 
[0m23:02:01.068627 [info ] [MainThread]:   compiled code at target/compiled/stock_transformations/models/fct_stock_abstract.sql
[0m23:02:01.069282 [info ] [MainThread]: 
[0m23:02:01.069952 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m23:02:01.076705 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6592207, "process_in_blocks": "0", "process_kernel_time": 1.230489, "process_mem_max_rss": "201179136", "process_out_blocks": "0", "process_user_time": 4.447503}
[0m23:02:01.077666 [debug] [MainThread]: Command `dbt run` failed at 23:02:01.077433 after 5.66 seconds
[0m23:02:01.078215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11038fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103155d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe4a210>]}
[0m23:02:01.078726 [debug] [MainThread]: Flushing usage events
[0m23:02:02.711865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:36.214177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b45ba50>]}


============================== 23:03:36.222330 | 6adeece8-b19d-41f7-9b79-b350e3c6a5ba ==============================
[0m23:03:36.222330 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:03:36.223126 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False', 'printer_width': '80', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True'}
[0m23:03:38.300347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6adeece8-b19d-41f7-9b79-b350e3c6a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137993090>]}
[0m23:03:38.377094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6adeece8-b19d-41f7-9b79-b350e3c6a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b438d50>]}
[0m23:03:38.378680 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:03:38.559223 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:03:38.712840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:03:38.713640 [debug] [MainThread]: Partial parsing: updated file: stock_transformations://models/fct_stock_abstract.sql
[0m23:03:39.088478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6adeece8-b19d-41f7-9b79-b350e3c6a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afa2fd0>]}
[0m23:03:39.167728 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:03:39.170379 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:03:39.197809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6adeece8-b19d-41f7-9b79-b350e3c6a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378c3790>]}
[0m23:03:39.198500 [info ] [MainThread]: Found 2 models, 1 source, 496 macros
[0m23:03:39.198970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6adeece8-b19d-41f7-9b79-b350e3c6a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378a2d10>]}
[0m23:03:39.200585 [info ] [MainThread]: 
[0m23:03:39.201055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:39.201464 [info ] [MainThread]: 
[0m23:03:39.202080 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:39.206459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m23:03:39.354490 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m23:03:39.354993 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m23:03:39.355366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:40.518698 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.163 seconds
[0m23:03:40.523478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m23:03:40.540430 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m23:03:40.540985 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m23:03:40.724892 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.183 seconds
[0m23:03:40.732006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6adeece8-b19d-41f7-9b79-b350e3c6a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0cae50>]}
[0m23:03:40.738050 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m23:03:40.739195 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m23:03:40.740051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now model.stock_transformations.stg_stock_prices)
[0m23:03:40.740714 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m23:03:40.751052 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m23:03:40.752707 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m23:03:40.788853 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m23:03:40.790577 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m23:03:40.791301 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */;
[0m23:03:41.131219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.339 seconds
[0m23:03:41.161891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adeece8-b19d-41f7-9b79-b350e3c6a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13817b050>]}
[0m23:03:41.162771 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 0.42s]
[0m23:03:41.163533 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m23:03:41.164501 [debug] [Thread-1 (]: Began running node model.stock_transformations.fct_stock_abstract
[0m23:03:41.165190 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.FCT_STOCK_ABSTRACT ...................... [RUN]
[0m23:03:41.165727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_transformations.stg_stock_prices, now model.stock_transformations.fct_stock_abstract)
[0m23:03:41.166150 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.fct_stock_abstract
[0m23:03:41.169504 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.fct_stock_abstract"
[0m23:03:41.170717 [debug] [Thread-1 (]: Began executing node model.stock_transformations.fct_stock_abstract
[0m23:03:41.198171 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.fct_stock_abstract"
[0m23:03:41.201257 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.fct_stock_abstract"
[0m23:03:41.202736 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: create or replace transient table USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
    
    
    
    as (

with base as (
  select
    symbol,
    dt,
    open, high, low, close, volume,
    row_number() over (partition by symbol order by dt) as rn,
    lag(close) over (partition by symbol order by dt) as prev_close
  from USER_DB_BOA.analytics.stg_stock_prices
),
deltas as (
  select
    *,
    iff(prev_close is null, null, greatest(close - prev_close, 0)) as gain,
    iff(prev_close is null, null, greatest(prev_close - close, 0)) as loss
  from base
),
ma as (
  select
    *,
    avg(close) over (partition by symbol order by dt rows between 6 preceding and current row)  as sma_7,
    avg(close) over (partition by symbol order by dt rows between 13 preceding and current row) as sma_14,
    avg(close) over (partition by symbol order by dt rows between 29 preceding and current row) as sma_30,
    lag(close, 7) over (partition by symbol order by dt) as close_7
  from deltas
),
rsi as (
  select
    *,
    avg(gain) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_gain_14,
    avg(loss) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_loss_14
  from ma
)
select
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  case
    when avg_loss_14 = 0 then 100
    when avg_gain_14 = 0 then 0
    when avg_gain_14 is null or avg_loss_14 is null then null
    else 100 - 100 / (1 + (avg_gain_14 / avg_loss_14))
  end as rsi_14,
  iff(close_7 is null, null, (close / nullif(close_7, 0)) - 1) as momentum_7d
from rsi
qualify rn > 30
order by symbol, dt
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.fct_stock_abstract"} */;
[0m23:03:43.622850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.419 seconds
[0m23:03:43.627237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6adeece8-b19d-41f7-9b79-b350e3c6a5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d8c450>]}
[0m23:03:43.628438 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.FCT_STOCK_ABSTRACT ................. [[32mSUCCESS 1[0m in 2.46s]
[0m23:03:43.629422 [debug] [Thread-1 (]: Finished running node model.stock_transformations.fct_stock_abstract
[0m23:03:43.631196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:43.631747 [debug] [MainThread]: Connection 'model.stock_transformations.fct_stock_abstract' was left open.
[0m23:03:43.632291 [debug] [MainThread]: On model.stock_transformations.fct_stock_abstract: Close
[0m23:03:43.773132 [info ] [MainThread]: 
[0m23:03:43.774198 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m23:03:43.775947 [debug] [MainThread]: Command end result
[0m23:03:43.806225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:03:43.808123 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:03:43.815542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:03:43.815978 [info ] [MainThread]: 
[0m23:03:43.816446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:43.816817 [info ] [MainThread]: 
[0m23:03:43.817407 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:03:43.824933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.698484, "process_in_blocks": "0", "process_kernel_time": 1.21681, "process_mem_max_rss": "201064448", "process_out_blocks": "0", "process_user_time": 4.4873}
[0m23:03:43.825687 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:43.825568 after 7.70 seconds
[0m23:03:43.826161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b45bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107562590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1d31d0>]}
[0m23:03:43.826603 [debug] [MainThread]: Flushing usage events
[0m23:03:44.279743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:12.683340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9d11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa38f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa3b750>]}


============================== 23:05:12.696177 | 807ae2ab-a852-467b-b0f3-461499e91de8 ==============================
[0m23:05:12.696177 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:05:12.697559 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'None', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m23:05:14.783528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '807ae2ab-a852-467b-b0f3-461499e91de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef9ced0>]}
[0m23:05:14.851245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '807ae2ab-a852-467b-b0f3-461499e91de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13beadbd0>]}
[0m23:05:14.852769 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:05:15.030566 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:05:15.190832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:15.191415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:15.227182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '807ae2ab-a852-467b-b0f3-461499e91de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c07e410>]}
[0m23:05:15.312612 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:05:15.315055 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:05:15.356285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '807ae2ab-a852-467b-b0f3-461499e91de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c58e510>]}
[0m23:05:15.356969 [info ] [MainThread]: Found 2 models, 1 source, 496 macros
[0m23:05:15.357493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '807ae2ab-a852-467b-b0f3-461499e91de8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9c3e10>]}
[0m23:05:15.359038 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:05:15.361183 [debug] [MainThread]: Command end result
[0m23:05:15.475127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:05:15.477060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:05:15.480824 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:05:15.487528 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8896337, "process_in_blocks": "0", "process_kernel_time": 1.05359, "process_mem_max_rss": "177651712", "process_out_blocks": "0", "process_user_time": 3.679971}
[0m23:05:15.488760 [debug] [MainThread]: Command `dbt test` succeeded at 23:05:15.488534 after 2.89 seconds
[0m23:05:15.489599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8ffd0>]}
[0m23:05:15.490250 [debug] [MainThread]: Flushing usage events
[0m23:05:15.991350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:01.990943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4e9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f574490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f575110>]}


============================== 23:08:02.005927 | 741d5274-a5df-4959-b216-e5ef224f80d8 ==============================
[0m23:08:02.005927 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:08:02.006809 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'None', 'debug': 'False', 'log_format': 'default', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'invocation_command': 'dbt test', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'no_print': 'None', 'profiles_dir': '.'}
[0m23:08:04.190320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '741d5274-a5df-4959-b216-e5ef224f80d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ad54b90>]}
[0m23:08:04.269346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '741d5274-a5df-4959-b216-e5ef224f80d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b969a90>]}
[0m23:08:04.270644 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:08:04.472705 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:08:04.648207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:08:04.648981 [debug] [MainThread]: Partial parsing: added file: stock_transformations://models/schema.yml
[0m23:08:04.733101 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'session_summary' in the 'models' section of file 'models/schema.yml'
[0m23:08:04.951312 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_transformations.not_null_session_summary_sessionId.e6aec1a6c6' (models/schema.yml) depends on a node named 'session_summary' in package '' which was not found
[0m23:08:04.952072 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_transformations.unique_session_summary_sessionId.9c5e5661a0' (models/schema.yml) depends on a node named 'session_summary' in package '' which was not found
[0m23:08:05.080632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '741d5274-a5df-4959-b216-e5ef224f80d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bf6b0d0>]}
[0m23:08:05.189276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:08:05.191571 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:08:05.227772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '741d5274-a5df-4959-b216-e5ef224f80d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c1bb050>]}
[0m23:08:05.228423 [info ] [MainThread]: Found 2 models, 1 source, 496 macros
[0m23:08:05.228846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '741d5274-a5df-4959-b216-e5ef224f80d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13baad990>]}
[0m23:08:05.230475 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:08:05.231558 [debug] [MainThread]: Command end result
[0m23:08:05.261593 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:08:05.263148 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:08:05.268567 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:08:05.276199 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.4003832, "process_in_blocks": "0", "process_kernel_time": 1.110746, "process_mem_max_rss": "177119232", "process_out_blocks": "0", "process_user_time": 4.098817}
[0m23:08:05.277171 [debug] [MainThread]: Command `dbt test` succeeded at 23:08:05.277022 after 3.40 seconds
[0m23:08:05.277703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f563bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f563850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5d7410>]}
[0m23:08:05.278194 [debug] [MainThread]: Flushing usage events
[0m23:08:05.804968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:41.265590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108714b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108775250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108798ed0>]}


============================== 23:11:41.275428 | 74c1ef71-d2a0-47ee-814f-a6704ae44273 ==============================
[0m23:11:41.275428 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:11:41.276372 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'False'}
[0m23:11:43.420684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74c1ef71-d2a0-47ee-814f-a6704ae44273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c05f50>]}
[0m23:11:43.497854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74c1ef71-d2a0-47ee-814f-a6704ae44273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134cd18d0>]}
[0m23:11:43.499055 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:11:43.683064 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:11:43.865069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:43.865865 [debug] [MainThread]: Partial parsing: updated file: stock_transformations://models/schema.yml
[0m23:11:43.950428 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'FCT_STOCK_ABSTRACT' in the 'models' section of file 'models/schema.yml'
[0m23:11:44.148743 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_transformations.not_null_FCT_STOCK_ABSTRACT_sessionId.7daf011700' (models/schema.yml) depends on a node named 'FCT_STOCK_ABSTRACT' in package '' which was not found
[0m23:11:44.149350 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_transformations.unique_FCT_STOCK_ABSTRACT_sessionId.f6068ac72a' (models/schema.yml) depends on a node named 'FCT_STOCK_ABSTRACT' in package '' which was not found
[0m23:11:44.269311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74c1ef71-d2a0-47ee-814f-a6704ae44273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134cb25d0>]}
[0m23:11:44.368857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:11:44.371157 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:11:44.395699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74c1ef71-d2a0-47ee-814f-a6704ae44273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134cc0e90>]}
[0m23:11:44.396367 [info ] [MainThread]: Found 2 models, 1 source, 496 macros
[0m23:11:44.396899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74c1ef71-d2a0-47ee-814f-a6704ae44273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134c78cd0>]}
[0m23:11:44.398540 [info ] [MainThread]: 
[0m23:11:44.398998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:11:44.399396 [info ] [MainThread]: 
[0m23:11:44.399970 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:11:44.404436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m23:11:44.582389 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m23:11:44.582940 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m23:11:44.583341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:45.907266 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.324 seconds
[0m23:11:45.912120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m23:11:45.931063 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m23:11:45.931630 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m23:11:46.107432 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.175 seconds
[0m23:11:46.114855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74c1ef71-d2a0-47ee-814f-a6704ae44273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc1a50>]}
[0m23:11:46.120525 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m23:11:46.121484 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m23:11:46.122315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now model.stock_transformations.stg_stock_prices)
[0m23:11:46.122951 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m23:11:46.132756 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m23:11:46.134765 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m23:11:46.172809 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m23:11:46.174533 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m23:11:46.175062 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */;
[0m23:11:46.518136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m23:11:46.552911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74c1ef71-d2a0-47ee-814f-a6704ae44273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135327a10>]}
[0m23:11:46.553963 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 0.43s]
[0m23:11:46.554744 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m23:11:46.555632 [debug] [Thread-1 (]: Began running node model.stock_transformations.fct_stock_abstract
[0m23:11:46.556281 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.FCT_STOCK_ABSTRACT ...................... [RUN]
[0m23:11:46.556863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_transformations.stg_stock_prices, now model.stock_transformations.fct_stock_abstract)
[0m23:11:46.557321 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.fct_stock_abstract
[0m23:11:46.560997 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.fct_stock_abstract"
[0m23:11:46.561845 [debug] [Thread-1 (]: Began executing node model.stock_transformations.fct_stock_abstract
[0m23:11:46.591816 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.fct_stock_abstract"
[0m23:11:46.595826 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.fct_stock_abstract"
[0m23:11:46.596480 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: create or replace transient table USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
    
    
    
    as (

with base as (
  select
    symbol,
    dt,
    open, high, low, close, volume,
    row_number() over (partition by symbol order by dt) as rn,
    lag(close) over (partition by symbol order by dt) as prev_close
  from USER_DB_BOA.analytics.stg_stock_prices
),
deltas as (
  select
    *,
    iff(prev_close is null, null, greatest(close - prev_close, 0)) as gain,
    iff(prev_close is null, null, greatest(prev_close - close, 0)) as loss
  from base
),
ma as (
  select
    *,
    avg(close) over (partition by symbol order by dt rows between 6 preceding and current row)  as sma_7,
    avg(close) over (partition by symbol order by dt rows between 13 preceding and current row) as sma_14,
    avg(close) over (partition by symbol order by dt rows between 29 preceding and current row) as sma_30,
    lag(close, 7) over (partition by symbol order by dt) as close_7
  from deltas
),
rsi as (
  select
    *,
    avg(gain) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_gain_14,
    avg(loss) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_loss_14
  from ma
)
select
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  case
    when avg_loss_14 = 0 then 100
    when avg_gain_14 = 0 then 0
    when avg_gain_14 is null or avg_loss_14 is null then null
    else 100 - 100 / (1 + (avg_gain_14 / avg_loss_14))
  end as rsi_14,
  iff(close_7 is null, null, (close / nullif(close_7, 0)) - 1) as momentum_7d
from rsi
qualify rn > 30
order by symbol, dt
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.fct_stock_abstract"} */;
[0m23:11:48.561904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.965 seconds
[0m23:11:48.566216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74c1ef71-d2a0-47ee-814f-a6704ae44273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1356d2210>]}
[0m23:11:48.567222 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.FCT_STOCK_ABSTRACT ................. [[32mSUCCESS 1[0m in 2.01s]
[0m23:11:48.568206 [debug] [Thread-1 (]: Finished running node model.stock_transformations.fct_stock_abstract
[0m23:11:48.569979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:48.570543 [debug] [MainThread]: Connection 'model.stock_transformations.fct_stock_abstract' was left open.
[0m23:11:48.571015 [debug] [MainThread]: On model.stock_transformations.fct_stock_abstract: Close
[0m23:11:48.704389 [info ] [MainThread]: 
[0m23:11:48.705268 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m23:11:48.706876 [debug] [MainThread]: Command end result
[0m23:11:48.736172 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:11:48.738533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:11:48.746945 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:11:48.747635 [info ] [MainThread]: 
[0m23:11:48.748685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:48.749347 [info ] [MainThread]: 
[0m23:11:48.750012 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:11:48.756585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.584019, "process_in_blocks": "0", "process_kernel_time": 1.207745, "process_mem_max_rss": "201715712", "process_out_blocks": "0", "process_user_time": 4.501535}
[0m23:11:48.757362 [debug] [MainThread]: Command `dbt run` succeeded at 23:11:48.757229 after 7.58 seconds
[0m23:11:48.758135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108502e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480f3d0>]}
[0m23:11:48.758992 [debug] [MainThread]: Flushing usage events
[0m23:11:49.227350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:08.899854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11426e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ff6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11428ffd0>]}


============================== 23:21:08.913681 | 2c5e11ae-bf8c-43a6-8b6e-47b995ac602a ==============================
[0m23:21:08.913681 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:21:08.914677 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None'}
[0m23:21:08.918504 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'stock_transformations'
[0m23:21:08.922633 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 0.11068461, "process_in_blocks": "0", "process_kernel_time": 0.419489, "process_mem_max_rss": "96452608", "process_out_blocks": "0", "process_user_time": 1.684039}
[0m23:21:08.923572 [debug] [MainThread]: Command `dbt snapshot` failed at 23:21:08.923415 after 0.11 seconds
[0m23:21:08.924127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114267ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110386490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f3410>]}
[0m23:21:08.924696 [debug] [MainThread]: Flushing usage events
[0m23:21:09.451256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:45.642376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4947d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a50bfd0>]}


============================== 23:21:45.650222 | cb1d1190-15f8-4d80-bca4-4bd9cbf96b6a ==============================
[0m23:21:45.650222 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:21:45.651024 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'debug': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m23:21:47.668048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb1d1190-15f8-4d80-bca4-4bd9cbf96b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a60fd0>]}
[0m23:21:47.735706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb1d1190-15f8-4d80-bca4-4bd9cbf96b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1369010d0>]}
[0m23:21:47.737567 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:21:47.923443 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:21:48.107846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:21:48.108491 [debug] [MainThread]: Partial parsing: added file: stock_transformations://snapshots/fct_stock_abstract_snapshot.sql
[0m23:21:48.400867 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot fct_stock_abstract_snapshot (snapshots/fct_stock_abstract_snapshot.sql)
  invalid syntax for function call expression
    line 3
      config(
[0m23:21:48.408351 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.8479292, "process_in_blocks": "0", "process_kernel_time": 1.007899, "process_mem_max_rss": "177704960", "process_out_blocks": "0", "process_user_time": 3.72818}
[0m23:21:48.409219 [debug] [MainThread]: Command `dbt snapshot` failed at 23:21:48.409069 after 2.85 seconds
[0m23:21:48.409831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fe810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fccf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f49690>]}
[0m23:21:48.410411 [debug] [MainThread]: Flushing usage events
[0m23:21:48.850507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:53.795882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2d410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5bed0>]}


============================== 23:22:53.802329 | bcb2ad70-5adb-478b-ab0f-ed1876bf3192 ==============================
[0m23:22:53.802329 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:22:53.803040 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt snapshot', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True'}
[0m23:22:54.895178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb2ad70-5adb-478b-ab0f-ed1876bf3192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed2250>]}
[0m23:22:54.961722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcb2ad70-5adb-478b-ab0f-ed1876bf3192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133e955d0>]}
[0m23:22:54.962678 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:22:55.122872 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:22:55.294169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:22:55.294864 [debug] [MainThread]: Partial parsing: added file: stock_transformations://snapshots/fct_stock_abstract_snapshot.sql
[0m23:22:55.608078 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot fct_stock_abstract_snapshot (snapshots/fct_stock_abstract_snapshot.sql)
  expected token ',', got 'snapshots'
    line 4
      -- Put snapshots in their own schema, or change to 'ANALYTICS' if you prefer:
[0m23:22:55.613857 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 1.9008312, "process_in_blocks": "0", "process_kernel_time": 0.695194, "process_mem_max_rss": "177352704", "process_out_blocks": "0", "process_user_time": 3.348758}
[0m23:22:55.614574 [debug] [MainThread]: Command `dbt snapshot` failed at 23:22:55.614449 after 1.90 seconds
[0m23:22:55.615091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abc090>]}
[0m23:22:55.615586 [debug] [MainThread]: Flushing usage events
[0m23:22:56.282105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:24:23.047219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112847850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112867bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112867fd0>]}


============================== 23:24:23.055545 | 5191dd45-a6c4-4ae6-94ca-82075effb52a ==============================
[0m23:24:23.055545 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:24:23.056388 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'empty': 'False', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'log_cache_events': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default'}
[0m23:24:25.114558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5191dd45-a6c4-4ae6-94ca-82075effb52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ee04790>]}
[0m23:24:25.181646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5191dd45-a6c4-4ae6-94ca-82075effb52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ebd9310>]}
[0m23:24:25.183197 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:24:25.358462 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:24:25.539343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:24:25.540032 [debug] [MainThread]: Partial parsing: added file: stock_transformations://snapshots/fct_stock_abstract_snapshot.sql
[0m23:24:25.842533 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot fct_stock_abstract_snapshot (snapshots/fct_stock_abstract_snapshot.sql)
  invalid syntax for function call expression
    line 3
      config(
[0m23:24:25.853849 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.891633, "process_in_blocks": "0", "process_kernel_time": 1.029671, "process_mem_max_rss": "176730112", "process_out_blocks": "0", "process_user_time": 3.69871}
[0m23:24:25.854896 [debug] [MainThread]: Command `dbt snapshot` failed at 23:24:25.854711 after 2.89 seconds
[0m23:24:25.855629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8e7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f3112d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8e7ed0>]}
[0m23:24:25.856323 [debug] [MainThread]: Flushing usage events
[0m23:24:26.441012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:17.954524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e9d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b86e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113efbd50>]}


============================== 23:27:17.970407 | 3fcd97f7-2eb1-4da4-bf55-da7910d581d4 ==============================
[0m23:27:17.970407 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:27:17.973677 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m23:27:20.118094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fcd97f7-2eb1-4da4-bf55-da7910d581d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140485890>]}
[0m23:27:20.197163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fcd97f7-2eb1-4da4-bf55-da7910d581d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1402f9410>]}
[0m23:27:20.198592 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:27:20.389263 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:27:20.586788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:27:20.587569 [debug] [MainThread]: Partial parsing: added file: stock_transformations://snapshots/fct_stock_abstract_snapshot.sql
[0m23:27:20.599713 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "stock_indicators') if that’s your file name
  {% endsnapshot %}"
[0m23:27:20.606305 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": false, "command_wall_clock_time": 2.8153253, "process_in_blocks": "0", "process_kernel_time": 1.127922, "process_mem_max_rss": "175448064", "process_out_blocks": "0", "process_user_time": 3.632134}
[0m23:27:20.607103 [debug] [MainThread]: Command `dbt snapshot` failed at 23:27:20.606975 after 2.82 seconds
[0m23:27:20.607710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f07610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e9c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404e9bd0>]}
[0m23:27:20.608218 [debug] [MainThread]: Flushing usage events
[0m23:27:21.202843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:19.313007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec49250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecb7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecb7ad0>]}


============================== 23:29:19.321124 | c1701a7e-0e89-49ad-9c00-4a6d101feade ==============================
[0m23:29:19.321124 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:29:19.321927 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'debug': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt snapshot', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m23:29:21.297640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1701a7e-0e89-49ad-9c00-4a6d101feade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b20ff50>]}
[0m23:29:21.364406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1701a7e-0e89-49ad-9c00-4a6d101feade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e159290>]}
[0m23:29:21.366178 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:29:21.563278 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:29:21.745890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:29:21.746528 [debug] [MainThread]: Partial parsing: added file: stock_transformations://snapshots/fct_stock_abstract_snapshot.sql
[0m23:29:22.186168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1701a7e-0e89-49ad-9c00-4a6d101feade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b187790>]}
[0m23:29:22.291086 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:29:22.293613 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:29:22.319811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1701a7e-0e89-49ad-9c00-4a6d101feade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b1f41d0>]}
[0m23:29:22.320474 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 496 macros
[0m23:29:22.320948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1701a7e-0e89-49ad-9c00-4a6d101feade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcae450>]}
[0m23:29:22.322551 [info ] [MainThread]: 
[0m23:29:22.323029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:22.323440 [info ] [MainThread]: 
[0m23:29:22.324072 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:29:22.325021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m23:29:22.482784 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m23:29:22.483348 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m23:29:22.483768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:23.686542 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.203 seconds
[0m23:29:23.697756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_SNAPSHOT)
[0m23:29:23.714546 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m23:29:23.715059 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: show objects in USER_DB_BOA.SNAPSHOT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */;
[0m23:29:23.863469 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.148 seconds
[0m23:29:23.867517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now list_USER_DB_BOA_analytics)
[0m23:29:23.871873 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m23:29:23.872485 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m23:29:23.995012 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.122 seconds
[0m23:29:24.002154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1701a7e-0e89-49ad-9c00-4a6d101feade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba1ac90>]}
[0m23:29:24.006421 [debug] [Thread-1 (]: Began running node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m23:29:24.007385 [info ] [Thread-1 (]: 1 of 1 START snapshot SNAPSHOT.fct_stock_abstract_snapshot ..................... [RUN]
[0m23:29:24.008117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now snapshot.stock_transformations.fct_stock_abstract_snapshot)
[0m23:29:24.008702 [debug] [Thread-1 (]: Began compiling node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m23:29:24.018529 [debug] [Thread-1 (]: Began executing node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m23:29:24.107125 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m23:29:24.107711 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: select * from (
        
    

    select *,
        md5(coalesce(cast(snap_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m23:29:24.929549 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.821 seconds
[0m23:29:24.935744 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m23:29:24.936472 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m23:29:25.059507 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.122 seconds
[0m23:29:25.061022 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m23:29:25.065682 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m23:29:25.066648 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: create or replace transient table USER_DB_BOA.SNAPSHOT.fct_stock_abstract_snapshot
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(snap_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */;
[0m23:29:26.128027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.060 seconds
[0m23:29:26.161572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1701a7e-0e89-49ad-9c00-4a6d101feade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b2a1050>]}
[0m23:29:26.162533 [info ] [Thread-1 (]: 1 of 1 OK snapshotted SNAPSHOT.fct_stock_abstract_snapshot ..................... [[32mSUCCESS 1[0m in 2.15s]
[0m23:29:26.163242 [debug] [Thread-1 (]: Finished running node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m23:29:26.164677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:26.165075 [debug] [MainThread]: Connection 'snapshot.stock_transformations.fct_stock_abstract_snapshot' was left open.
[0m23:29:26.165440 [debug] [MainThread]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: Close
[0m23:29:26.282663 [info ] [MainThread]: 
[0m23:29:26.283718 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m23:29:26.285208 [debug] [MainThread]: Command end result
[0m23:29:26.316964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:29:26.319148 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:29:26.327374 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:29:26.327900 [info ] [MainThread]: 
[0m23:29:26.328738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:26.329376 [info ] [MainThread]: 
[0m23:29:26.329913 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:29:26.336325 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.109562, "process_in_blocks": "0", "process_kernel_time": 1.208084, "process_mem_max_rss": "202530816", "process_out_blocks": "0", "process_user_time": 4.625535}
[0m23:29:26.337146 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:29:26.336970 after 7.11 seconds
[0m23:29:26.338448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad1b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ba61f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad2c110>]}
[0m23:29:26.339582 [debug] [MainThread]: Flushing usage events
[0m23:29:26.788983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:23:22.074473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffbe714c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffbe98a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffbe12d50>]}


============================== 08:23:22.089559 | ca4ac00a-0d5a-4177-9f17-02f671686ee3 ==============================
[0m08:23:22.089559 [info ] [MainThread]: Running with dbt=1.7.19
[0m08:23:22.090552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:23:22.100856 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ROLE'
[0m08:23:22.104893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.1014636, "process_user_time": 4.264204, "process_kernel_time": 1.673973, "process_mem_max_rss": "169760", "process_in_blocks": "4816", "process_out_blocks": "1354", "command_success": false}
[0m08:23:22.105770 [debug] [MainThread]: Command `dbt run` failed at 08:23:22.105625 after 0.10 seconds
[0m08:23:22.106582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8000576a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffc11b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ffbe98ef0>]}
[0m08:23:22.107238 [debug] [MainThread]: Flushing usage events
[0m05:04:06.782698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2940340170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29403f12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2940340650>]}


============================== 05:04:06.800204 | a9659f69-32fa-4cc2-8446-95391096c1f2 ==============================
[0m05:04:06.800204 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:04:06.801135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:04:08.660659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291ed45100>]}
[0m05:04:08.745872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2941676b10>]}
[0m05:04:08.747007 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m05:04:08.759888 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:04:08.792964 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m05:04:08.793953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291e988380>]}
[0m05:04:10.413834 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'FCT_STOCK_ABSTRACT' in the 'models' section of file 'models/schema.yml'
[0m05:04:10.731077 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_transformations.not_null_FCT_STOCK_ABSTRACT_sessionId.7daf011700' (models/schema.yml) depends on a node named 'FCT_STOCK_ABSTRACT' in package '' which was not found
[0m05:04:10.732049 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_transformations.unique_FCT_STOCK_ABSTRACT_sessionId.f6068ac72a' (models/schema.yml) depends on a node named 'FCT_STOCK_ABSTRACT' in package '' which was not found
[0m05:04:10.787081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291d612de0>]}
[0m05:04:10.810894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291d7b9070>]}
[0m05:04:10.811751 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m05:04:10.812386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291eb8b6e0>]}
[0m05:04:10.814754 [info ] [MainThread]: 
[0m05:04:10.816177 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:04:10.817985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m05:04:10.838484 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m05:04:10.839232 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m05:04:10.839863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:04:11.798375 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m05:04:11.802318 [debug] [ThreadPool]: On list_USER_DB_BOA: Close
[0m05:04:12.517607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m05:04:12.532934 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m05:04:12.533823 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000
[0m05:04:12.534606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:13.072378 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m05:04:13.077828 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: Close
[0m05:04:13.206045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now list_USER_DB_BOA_SNAPSHOT)
[0m05:04:13.214068 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m05:04:13.215042 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */
show objects in USER_DB_BOA.SNAPSHOT limit 10000
[0m05:04:13.215826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:13.699440 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:04:13.703467 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: Close
[0m05:04:13.979114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291d49e060>]}
[0m05:04:13.981550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:04:13.982714 [info ] [MainThread]: 
[0m05:04:13.998477 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m05:04:13.999604 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m05:04:14.001094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now model.stock_transformations.stg_stock_prices)
[0m05:04:14.002661 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m05:04:14.014466 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m05:04:14.018561 [debug] [Thread-1 (]: Timing info for model.stock_transformations.stg_stock_prices (compile): 05:04:14.003264 => 05:04:14.018164
[0m05:04:14.019428 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m05:04:14.066889 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m05:04:14.072017 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m05:04:14.073286 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */
create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
   as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  );
[0m05:04:14.074853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:15.359056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:04:15.397956 [debug] [Thread-1 (]: Timing info for model.stock_transformations.stg_stock_prices (execute): 05:04:14.020071 => 05:04:15.397657
[0m05:04:15.398771 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: Close
[0m05:04:15.841622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291d4d5d00>]}
[0m05:04:15.843505 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 1.84s]
[0m05:04:15.845585 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m05:04:15.847692 [debug] [Thread-1 (]: Began running node model.stock_transformations.fct_stock_abstract
[0m05:04:15.849000 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.FCT_STOCK_ABSTRACT ...................... [RUN]
[0m05:04:15.850482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_transformations.stg_stock_prices, now model.stock_transformations.fct_stock_abstract)
[0m05:04:15.851496 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.fct_stock_abstract
[0m05:04:15.858800 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.fct_stock_abstract"
[0m05:04:15.862343 [debug] [Thread-1 (]: Timing info for model.stock_transformations.fct_stock_abstract (compile): 05:04:15.852255 => 05:04:15.861874
[0m05:04:15.863269 [debug] [Thread-1 (]: Began executing node model.stock_transformations.fct_stock_abstract
[0m05:04:15.894783 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.fct_stock_abstract"
[0m05:04:15.899216 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.fct_stock_abstract"
[0m05:04:15.900167 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.fct_stock_abstract"} */
create or replace transient table USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
         as
        (

with base as (
  select
    symbol,
    dt,
    open, high, low, close, volume,
    row_number() over (partition by symbol order by dt) as rn,
    lag(close) over (partition by symbol order by dt) as prev_close
  from USER_DB_BOA.analytics.stg_stock_prices
),
deltas as (
  select
    *,
    iff(prev_close is null, null, greatest(close - prev_close, 0)) as gain,
    iff(prev_close is null, null, greatest(prev_close - close, 0)) as loss
  from base
),
ma as (
  select
    *,
    avg(close) over (partition by symbol order by dt rows between 6 preceding and current row)  as sma_7,
    avg(close) over (partition by symbol order by dt rows between 13 preceding and current row) as sma_14,
    avg(close) over (partition by symbol order by dt rows between 29 preceding and current row) as sma_30,
    lag(close, 7) over (partition by symbol order by dt) as close_7
  from deltas
),
rsi as (
  select
    *,
    avg(gain) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_gain_14,
    avg(loss) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_loss_14
  from ma
)
select
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  case
    when avg_loss_14 = 0 then 100
    when avg_gain_14 = 0 then 0
    when avg_gain_14 is null or avg_loss_14 is null then null
    else 100 - 100 / (1 + (avg_gain_14 / avg_loss_14))
  end as rsi_14,
  iff(close_7 is null, null, (close / nullif(close_7, 0)) - 1) as momentum_7d
from rsi
qualify rn > 30
order by symbol, dt
        );
[0m05:04:15.900987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:18.448178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m05:04:18.454504 [debug] [Thread-1 (]: Timing info for model.stock_transformations.fct_stock_abstract (execute): 05:04:15.864029 => 05:04:18.453869
[0m05:04:18.455753 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: Close
[0m05:04:18.778188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9659f69-32fa-4cc2-8446-95391096c1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291cb99b80>]}
[0m05:04:18.779459 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.FCT_STOCK_ABSTRACT ................. [[32mSUCCESS 1[0m in 2.93s]
[0m05:04:18.781268 [debug] [Thread-1 (]: Finished running node model.stock_transformations.fct_stock_abstract
[0m05:04:18.784285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:04:18.784926 [debug] [MainThread]: Connection 'model.stock_transformations.fct_stock_abstract' was properly closed.
[0m05:04:18.785611 [info ] [MainThread]: 
[0m05:04:18.786318 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 7.97 seconds (7.97s).
[0m05:04:18.788073 [debug] [MainThread]: Command end result
[0m05:04:18.803002 [info ] [MainThread]: 
[0m05:04:18.804123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:04:18.804824 [info ] [MainThread]: 
[0m05:04:18.805751 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:04:18.809209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.090829, "process_user_time": 8.123138, "process_kernel_time": 2.083495, "process_mem_max_rss": "225352", "process_in_blocks": "816", "process_out_blocks": "2705"}
[0m05:04:18.810951 [debug] [MainThread]: Command `dbt run` succeeded at 05:04:18.810593 after 12.09 seconds
[0m05:04:18.811709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29403f12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291e837fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291ea19d00>]}
[0m05:04:18.812307 [debug] [MainThread]: Flushing usage events
[0m05:04:24.279392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543b235100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543ba261e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543b33c350>]}


============================== 05:04:24.287950 | 3e783aa0-fb69-4eff-be95-7a8032ac7626 ==============================
[0m05:04:24.287950 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:04:24.288993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:04:25.451627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e783aa0-fb69-4eff-be95-7a8032ac7626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543b234d40>]}
[0m05:04:25.528593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e783aa0-fb69-4eff-be95-7a8032ac7626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f541e0d6f60>]}
[0m05:04:25.529672 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m05:04:25.541418 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:04:25.590439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:04:25.591284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:04:25.599963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e783aa0-fb69-4eff-be95-7a8032ac7626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f541daf74a0>]}
[0m05:04:25.620226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e783aa0-fb69-4eff-be95-7a8032ac7626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f541d99b230>]}
[0m05:04:25.621512 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m05:04:25.622901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e783aa0-fb69-4eff-be95-7a8032ac7626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f541ddc6ae0>]}
[0m05:04:25.626151 [info ] [MainThread]: 
[0m05:04:25.627343 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:04:25.628396 [debug] [MainThread]: Command end result
[0m05:04:25.647619 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4242752, "process_user_time": 5.179734, "process_kernel_time": 0.653895, "process_mem_max_rss": "209324", "process_out_blocks": "1700", "process_in_blocks": "0"}
[0m05:04:25.650118 [debug] [MainThread]: Command `dbt test` succeeded at 05:04:25.649613 after 1.43 seconds
[0m05:04:25.651655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543b6f8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543f93ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543b34ba70>]}
[0m05:04:25.653276 [debug] [MainThread]: Flushing usage events
[0m05:04:31.561474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480780dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480970e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48077c3b30>]}


============================== 05:04:31.569375 | a5ceaa79-bdca-4583-8650-58f074fd3ab5 ==============================
[0m05:04:31.569375 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:04:31.570412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:04:32.814326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5ceaa79-bdca-4583-8650-58f074fd3ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e9d1a960>]}
[0m05:04:32.910189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5ceaa79-bdca-4583-8650-58f074fd3ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47eaabf170>]}
[0m05:04:32.911414 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m05:04:32.922936 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:04:32.978975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:04:32.979667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:04:32.987759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5ceaa79-bdca-4583-8650-58f074fd3ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e9e695b0>]}
[0m05:04:33.003181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5ceaa79-bdca-4583-8650-58f074fd3ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e9c23620>]}
[0m05:04:33.003976 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m05:04:33.004676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ceaa79-bdca-4583-8650-58f074fd3ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48075bf800>]}
[0m05:04:33.007271 [info ] [MainThread]: 
[0m05:04:33.008884 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:04:33.011058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m05:04:33.030411 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m05:04:33.031170 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m05:04:33.031957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:04:33.698142 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m05:04:33.701689 [debug] [ThreadPool]: On list_USER_DB_BOA: Close
[0m05:04:33.883154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m05:04:33.898433 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m05:04:33.899331 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000
[0m05:04:33.900198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:34.643733 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m05:04:34.648623 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: Close
[0m05:04:34.787811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now list_USER_DB_BOA_SNAPSHOT)
[0m05:04:34.797513 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m05:04:34.798441 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */
show objects in USER_DB_BOA.SNAPSHOT limit 10000
[0m05:04:34.799284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:35.276349 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m05:04:35.279608 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: Close
[0m05:04:35.641043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5ceaa79-bdca-4583-8650-58f074fd3ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e9d3ee40>]}
[0m05:04:35.642957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:04:35.644249 [info ] [MainThread]: 
[0m05:04:35.657480 [debug] [Thread-1 (]: Began running node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m05:04:35.658677 [info ] [Thread-1 (]: 1 of 1 START snapshot SNAPSHOT.fct_stock_abstract_snapshot ..................... [RUN]
[0m05:04:35.660220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now snapshot.stock_transformations.fct_stock_abstract_snapshot)
[0m05:04:35.661890 [debug] [Thread-1 (]: Began compiling node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m05:04:35.676057 [debug] [Thread-1 (]: Timing info for snapshot.stock_transformations.fct_stock_abstract_snapshot (compile): 05:04:35.662459 => 05:04:35.675600
[0m05:04:35.677105 [debug] [Thread-1 (]: Began executing node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m05:04:35.763180 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:35.764044 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
select * from (
        select open, high, low, close, volume, sma_7, sma_14, sma_30, rsi_14, momentum_7d from (
                

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m05:04:35.764966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:36.779579 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m05:04:36.797090 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:36.798399 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
[0m05:04:36.960313 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.0 seconds
[0m05:04:36.974421 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:36.975422 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
[0m05:04:37.097127 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.0 seconds
[0m05:04:37.148568 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:37.150481 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
create or replace temporary table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT

    ),

    snapshotted_data as (

        select *,
            snap_id as dbt_unique_key

        from "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snap_id as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snap_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snap_id as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snap_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."SMA_7" != source_data."SMA_7"
        or
        (
            ((snapshotted_data."SMA_7" is null) and not (source_data."SMA_7" is null))
            or
            ((not snapshotted_data."SMA_7" is null) and (source_data."SMA_7" is null))
        ) or snapshotted_data."SMA_14" != source_data."SMA_14"
        or
        (
            ((snapshotted_data."SMA_14" is null) and not (source_data."SMA_14" is null))
            or
            ((not snapshotted_data."SMA_14" is null) and (source_data."SMA_14" is null))
        ) or snapshotted_data."SMA_30" != source_data."SMA_30"
        or
        (
            ((snapshotted_data."SMA_30" is null) and not (source_data."SMA_30" is null))
            or
            ((not snapshotted_data."SMA_30" is null) and (source_data."SMA_30" is null))
        ) or snapshotted_data."RSI_14" != source_data."RSI_14"
        or
        (
            ((snapshotted_data."RSI_14" is null) and not (source_data."RSI_14" is null))
            or
            ((not snapshotted_data."RSI_14" is null) and (source_data."RSI_14" is null))
        ) or snapshotted_data."MOMENTUM_7D" != source_data."MOMENTUM_7D"
        or
        (
            ((snapshotted_data."MOMENTUM_7D" is null) and not (source_data."MOMENTUM_7D" is null))
            or
            ((not snapshotted_data."MOMENTUM_7D" is null) and (source_data."MOMENTUM_7D" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."SMA_7" != source_data."SMA_7"
        or
        (
            ((snapshotted_data."SMA_7" is null) and not (source_data."SMA_7" is null))
            or
            ((not snapshotted_data."SMA_7" is null) and (source_data."SMA_7" is null))
        ) or snapshotted_data."SMA_14" != source_data."SMA_14"
        or
        (
            ((snapshotted_data."SMA_14" is null) and not (source_data."SMA_14" is null))
            or
            ((not snapshotted_data."SMA_14" is null) and (source_data."SMA_14" is null))
        ) or snapshotted_data."SMA_30" != source_data."SMA_30"
        or
        (
            ((snapshotted_data."SMA_30" is null) and not (source_data."SMA_30" is null))
            or
            ((not snapshotted_data."SMA_30" is null) and (source_data."SMA_30" is null))
        ) or snapshotted_data."RSI_14" != source_data."RSI_14"
        or
        (
            ((snapshotted_data."RSI_14" is null) and not (source_data."RSI_14" is null))
            or
            ((not snapshotted_data."RSI_14" is null) and (source_data."RSI_14" is null))
        ) or snapshotted_data."MOMENTUM_7D" != source_data."MOMENTUM_7D"
        or
        (
            ((snapshotted_data."MOMENTUM_7D" is null) and not (source_data."MOMENTUM_7D" is null))
            or
            ((not snapshotted_data."MOMENTUM_7D" is null) and (source_data."MOMENTUM_7D" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:04:38.622158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:04:38.627340 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:38.628347 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
[0m05:04:38.799962 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.0 seconds
[0m05:04:38.808645 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:38.809741 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
[0m05:04:38.911284 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.0 seconds
[0m05:04:38.919940 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:38.920998 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
[0m05:04:39.032436 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.0 seconds
[0m05:04:39.040028 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:39.040932 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
[0m05:04:39.173217 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.0 seconds
[0m05:04:39.188233 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:39.189276 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
[0m05:04:39.281526 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.0 seconds
[0m05:04:39.299436 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:39.304977 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:39.306030 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
BEGIN
[0m05:04:39.440775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:04:39.442198 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:39.443483 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
merge into "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAP_ID", "SYMBOL", "DT", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "SMA_7", "SMA_14", "SMA_30", "RSI_14", "MOMENTUM_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAP_ID", "SYMBOL", "DT", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "SMA_7", "SMA_14", "SMA_30", "RSI_14", "MOMENTUM_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:04:40.668491 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m05:04:40.671006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m05:04:40.672480 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
COMMIT
[0m05:04:41.135255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m05:04:41.172183 [debug] [Thread-1 (]: Timing info for snapshot.stock_transformations.fct_stock_abstract_snapshot (execute): 05:04:35.677750 => 05:04:41.171822
[0m05:04:41.173461 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: Close
[0m05:04:42.110688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5ceaa79-bdca-4583-8650-58f074fd3ab5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e8f6aba0>]}
[0m05:04:42.112661 [info ] [Thread-1 (]: 1 of 1 OK snapshotted SNAPSHOT.fct_stock_abstract_snapshot ..................... [[32mSUCCESS 0[0m in 6.45s]
[0m05:04:42.114471 [debug] [Thread-1 (]: Finished running node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m05:04:42.118272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:04:42.118974 [debug] [MainThread]: Connection 'snapshot.stock_transformations.fct_stock_abstract_snapshot' was properly closed.
[0m05:04:42.119602 [info ] [MainThread]: 
[0m05:04:42.120697 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.11 seconds (9.11s).
[0m05:04:42.122304 [debug] [MainThread]: Command end result
[0m05:04:42.136341 [info ] [MainThread]: 
[0m05:04:42.137390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:04:42.138372 [info ] [MainThread]: 
[0m05:04:42.139423 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:04:42.141272 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.642293, "process_user_time": 5.944824, "process_kernel_time": 0.771378, "process_mem_max_rss": "217976", "process_out_blocks": "1755", "process_in_blocks": "0"}
[0m05:04:42.142409 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:04:42.142215 after 10.64 seconds
[0m05:04:42.143370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480780dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480790cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48027b5d00>]}
[0m05:04:42.144577 [debug] [MainThread]: Flushing usage events
[0m06:53:48.161037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e92ac15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e92d643b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e9719cda0>]}


============================== 06:53:48.183659 | 5f791b78-9221-4316-a46a-1f7df0f033d4 ==============================
[0m06:53:48.183659 [info ] [MainThread]: Running with dbt=1.7.19
[0m06:53:48.184659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:53:50.386108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f791b78-9221-4316-a46a-1f7df0f033d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e76ad5e50>]}
[0m06:53:50.479309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f791b78-9221-4316-a46a-1f7df0f033d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75839460>]}
[0m06:53:50.480769 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m06:53:50.495232 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m06:53:50.591248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:50.592211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:50.601658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f791b78-9221-4316-a46a-1f7df0f033d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e754e2510>]}
[0m06:53:50.647345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f791b78-9221-4316-a46a-1f7df0f033d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7523af90>]}
[0m06:53:50.648750 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m06:53:50.650257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f791b78-9221-4316-a46a-1f7df0f033d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e757b4da0>]}
[0m06:53:50.655838 [info ] [MainThread]: 
[0m06:53:50.658350 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:53:50.662036 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m06:53:50.690797 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m06:53:50.691648 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m06:53:50.692393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:51.465083 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m06:53:51.470802 [debug] [ThreadPool]: On list_USER_DB_BOA: Close
[0m06:53:51.593413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m06:53:51.610265 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m06:53:51.611112 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000
[0m06:53:51.612064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:52.096719 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:53:52.109080 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: Close
[0m06:53:52.264900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now list_USER_DB_BOA_SNAPSHOT)
[0m06:53:52.274193 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m06:53:52.275051 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */
show objects in USER_DB_BOA.SNAPSHOT limit 10000
[0m06:53:52.275747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:53:52.730982 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:53:52.733495 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: Close
[0m06:53:52.854513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f791b78-9221-4316-a46a-1f7df0f033d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e756d9df0>]}
[0m06:53:52.855959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:53:52.856727 [info ] [MainThread]: 
[0m06:53:52.877991 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m06:53:52.879006 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m06:53:52.880207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now model.stock_transformations.stg_stock_prices)
[0m06:53:52.880965 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m06:53:52.893495 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m06:53:52.897971 [debug] [Thread-1 (]: Timing info for model.stock_transformations.stg_stock_prices (compile): 06:53:52.881500 => 06:53:52.897461
[0m06:53:52.898793 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m06:53:52.951397 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m06:53:52.956301 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m06:53:52.957926 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */
create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
   as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  );
[0m06:53:52.959071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:53.847493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:53:53.899630 [debug] [Thread-1 (]: Timing info for model.stock_transformations.stg_stock_prices (execute): 06:53:52.899316 => 06:53:53.899039
[0m06:53:53.901315 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: Close
[0m06:53:54.045711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f791b78-9221-4316-a46a-1f7df0f033d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e748c7710>]}
[0m06:53:54.049150 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 1.17s]
[0m06:53:54.053880 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m06:53:54.058728 [debug] [Thread-1 (]: Began running node model.stock_transformations.fct_stock_abstract
[0m06:53:54.061049 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.FCT_STOCK_ABSTRACT ...................... [RUN]
[0m06:53:54.066876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_transformations.stg_stock_prices, now model.stock_transformations.fct_stock_abstract)
[0m06:53:54.068975 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.fct_stock_abstract
[0m06:53:54.081105 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.fct_stock_abstract"
[0m06:53:54.088688 [debug] [Thread-1 (]: Timing info for model.stock_transformations.fct_stock_abstract (compile): 06:53:54.071449 => 06:53:54.088167
[0m06:53:54.090140 [debug] [Thread-1 (]: Began executing node model.stock_transformations.fct_stock_abstract
[0m06:53:54.158179 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.fct_stock_abstract"
[0m06:53:54.167007 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.fct_stock_abstract"
[0m06:53:54.168066 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.fct_stock_abstract"} */
create or replace transient table USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
         as
        (

with base as (
  select
    symbol,
    dt,
    open, high, low, close, volume,
    row_number() over (partition by symbol order by dt) as rn,
    lag(close) over (partition by symbol order by dt) as prev_close
  from USER_DB_BOA.analytics.stg_stock_prices
),
deltas as (
  select
    *,
    iff(prev_close is null, null, greatest(close - prev_close, 0)) as gain,
    iff(prev_close is null, null, greatest(prev_close - close, 0)) as loss
  from base
),
ma as (
  select
    *,
    avg(close) over (partition by symbol order by dt rows between 6 preceding and current row)  as sma_7,
    avg(close) over (partition by symbol order by dt rows between 13 preceding and current row) as sma_14,
    avg(close) over (partition by symbol order by dt rows between 29 preceding and current row) as sma_30,
    lag(close, 7) over (partition by symbol order by dt) as close_7
  from deltas
),
rsi as (
  select
    *,
    avg(gain) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_gain_14,
    avg(loss) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_loss_14
  from ma
)
select
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  case
    when avg_loss_14 = 0 then 100
    when avg_gain_14 = 0 then 0
    when avg_gain_14 is null or avg_loss_14 is null then null
    else 100 - 100 / (1 + (avg_gain_14 / avg_loss_14))
  end as rsi_14,
  iff(close_7 is null, null, (close / nullif(close_7, 0)) - 1) as momentum_7d
from rsi
qualify rn > 30
order by symbol, dt
        );
[0m06:53:54.169020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:56.372326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:53:56.376537 [debug] [Thread-1 (]: Timing info for model.stock_transformations.fct_stock_abstract (execute): 06:53:54.091366 => 06:53:56.376221
[0m06:53:56.377321 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: Close
[0m06:53:56.520112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f791b78-9221-4316-a46a-1f7df0f033d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e748c6390>]}
[0m06:53:56.521410 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.FCT_STOCK_ABSTRACT ................. [[32mSUCCESS 1[0m in 2.45s]
[0m06:53:56.523002 [debug] [Thread-1 (]: Finished running node model.stock_transformations.fct_stock_abstract
[0m06:53:56.526580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:53:56.527358 [debug] [MainThread]: Connection 'model.stock_transformations.fct_stock_abstract' was properly closed.
[0m06:53:56.528082 [info ] [MainThread]: 
[0m06:53:56.528745 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m06:53:56.530130 [debug] [MainThread]: Command end result
[0m06:53:56.549788 [info ] [MainThread]: 
[0m06:53:56.551494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:53:56.552829 [info ] [MainThread]: 
[0m06:53:56.553814 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:53:56.558058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.467228, "process_user_time": 7.074022, "process_kernel_time": 2.500564, "process_mem_max_rss": "216848", "process_out_blocks": "1749", "process_in_blocks": "0"}
[0m06:53:56.560009 [debug] [MainThread]: Command `dbt run` succeeded at 06:53:56.559609 after 8.47 seconds
[0m06:53:56.561057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e92d22510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e75653ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e933917f0>]}
[0m06:53:56.561805 [debug] [MainThread]: Flushing usage events
[0m06:54:04.070185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab23666630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab23768560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab23cc00b0>]}


============================== 06:54:04.079331 | 0370aa59-fbc8-44bd-83bf-323c87de234a ==============================
[0m06:54:04.079331 [info ] [MainThread]: Running with dbt=1.7.19
[0m06:54:04.080390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:54:05.671286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0370aa59-fbc8-44bd-83bf-323c87de234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab06165a60>]}
[0m06:54:05.764421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0370aa59-fbc8-44bd-83bf-323c87de234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab235bfa10>]}
[0m06:54:05.765612 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m06:54:05.779206 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m06:54:05.830608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:54:05.831408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:54:05.841205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0370aa59-fbc8-44bd-83bf-323c87de234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab235ee810>]}
[0m06:54:05.859898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0370aa59-fbc8-44bd-83bf-323c87de234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab05f76e70>]}
[0m06:54:05.861197 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m06:54:05.862485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0370aa59-fbc8-44bd-83bf-323c87de234a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab07648950>]}
[0m06:54:05.865891 [info ] [MainThread]: 
[0m06:54:05.866744 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:54:05.867684 [debug] [MainThread]: Command end result
[0m06:54:05.882164 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8760359, "process_user_time": 6.622101, "process_kernel_time": 0.696175, "process_mem_max_rss": "209420", "process_out_blocks": "1700", "process_in_blocks": "0"}
[0m06:54:05.883179 [debug] [MainThread]: Command `dbt test` succeeded at 06:54:05.883011 after 1.88 seconds
[0m06:54:05.883857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab23775790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab06863fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab06c8c4d0>]}
[0m06:54:05.884575 [debug] [MainThread]: Flushing usage events
[0m06:54:12.389229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcae7b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb1f4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcb1f48c0>]}


============================== 06:54:12.398194 | b84572f4-e3df-4d71-b82a-01a6d0628618 ==============================
[0m06:54:12.398194 [info ] [MainThread]: Running with dbt=1.7.19
[0m06:54:12.399345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:54:14.022455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b84572f4-e3df-4d71-b82a-01a6d0628618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdae37af90>]}
[0m06:54:14.175568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b84572f4-e3df-4d71-b82a-01a6d0628618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcaec8d10>]}
[0m06:54:14.176816 [info ] [MainThread]: Registered adapter: snowflake=1.7.5
[0m06:54:14.191329 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m06:54:14.239355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:54:14.240079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:54:14.247954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b84572f4-e3df-4d71-b82a-01a6d0628618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdad9a9340>]}
[0m06:54:14.263859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b84572f4-e3df-4d71-b82a-01a6d0628618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdad482c30>]}
[0m06:54:14.265045 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m06:54:14.270680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84572f4-e3df-4d71-b82a-01a6d0628618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcadf9dc0>]}
[0m06:54:14.276398 [info ] [MainThread]: 
[0m06:54:14.279188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:54:14.281563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m06:54:14.350392 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m06:54:14.353561 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m06:54:14.355292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:15.070113 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m06:54:15.081523 [debug] [ThreadPool]: On list_USER_DB_BOA: Close
[0m06:54:15.224973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_SNAPSHOT)
[0m06:54:15.240927 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m06:54:15.241828 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */
show objects in USER_DB_BOA.SNAPSHOT limit 10000
[0m06:54:15.242592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:15.683420 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:54:15.687062 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: Close
[0m06:54:15.832246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now list_USER_DB_BOA_analytics)
[0m06:54:15.838571 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m06:54:15.839253 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000
[0m06:54:15.839790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:16.243502 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:54:16.246434 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: Close
[0m06:54:16.363459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b84572f4-e3df-4d71-b82a-01a6d0628618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdad5f6690>]}
[0m06:54:16.365082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:54:16.365782 [info ] [MainThread]: 
[0m06:54:16.378371 [debug] [Thread-1 (]: Began running node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m06:54:16.379873 [info ] [Thread-1 (]: 1 of 1 START snapshot SNAPSHOT.fct_stock_abstract_snapshot ..................... [RUN]
[0m06:54:16.381240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now snapshot.stock_transformations.fct_stock_abstract_snapshot)
[0m06:54:16.382187 [debug] [Thread-1 (]: Began compiling node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m06:54:16.394983 [debug] [Thread-1 (]: Timing info for snapshot.stock_transformations.fct_stock_abstract_snapshot (compile): 06:54:16.382739 => 06:54:16.394525
[0m06:54:16.395813 [debug] [Thread-1 (]: Began executing node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m06:54:16.486714 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:16.487926 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
select * from (
        select open, high, low, close, volume, sma_7, sma_14, sma_30, rsi_14, momentum_7d from (
                

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
            ) subq
    ) as __dbt_sbq
    where false
    limit 0
[0m06:54:16.488953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:17.035098 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m06:54:17.051685 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:17.053160 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
[0m06:54:17.157702 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.0 seconds
[0m06:54:17.169610 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:17.171017 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
[0m06:54:17.267548 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.0 seconds
[0m06:54:17.328083 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:17.330272 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
create or replace temporary table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
         as
        (with snapshot_query as (

        

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT

    ),

    snapshotted_data as (

        select *,
            snap_id as dbt_unique_key

        from "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            snap_id as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to,
            md5(coalesce(cast(snap_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            snap_id as dbt_unique_key,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            snap_id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."SMA_7" != source_data."SMA_7"
        or
        (
            ((snapshotted_data."SMA_7" is null) and not (source_data."SMA_7" is null))
            or
            ((not snapshotted_data."SMA_7" is null) and (source_data."SMA_7" is null))
        ) or snapshotted_data."SMA_14" != source_data."SMA_14"
        or
        (
            ((snapshotted_data."SMA_14" is null) and not (source_data."SMA_14" is null))
            or
            ((not snapshotted_data."SMA_14" is null) and (source_data."SMA_14" is null))
        ) or snapshotted_data."SMA_30" != source_data."SMA_30"
        or
        (
            ((snapshotted_data."SMA_30" is null) and not (source_data."SMA_30" is null))
            or
            ((not snapshotted_data."SMA_30" is null) and (source_data."SMA_30" is null))
        ) or snapshotted_data."RSI_14" != source_data."RSI_14"
        or
        (
            ((snapshotted_data."RSI_14" is null) and not (source_data."RSI_14" is null))
            or
            ((not snapshotted_data."RSI_14" is null) and (source_data."RSI_14" is null))
        ) or snapshotted_data."MOMENTUM_7D" != source_data."MOMENTUM_7D"
        or
        (
            ((snapshotted_data."MOMENTUM_7D" is null) and not (source_data."MOMENTUM_7D" is null))
            or
            ((not snapshotted_data."MOMENTUM_7D" is null) and (source_data."MOMENTUM_7D" is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."SMA_7" != source_data."SMA_7"
        or
        (
            ((snapshotted_data."SMA_7" is null) and not (source_data."SMA_7" is null))
            or
            ((not snapshotted_data."SMA_7" is null) and (source_data."SMA_7" is null))
        ) or snapshotted_data."SMA_14" != source_data."SMA_14"
        or
        (
            ((snapshotted_data."SMA_14" is null) and not (source_data."SMA_14" is null))
            or
            ((not snapshotted_data."SMA_14" is null) and (source_data."SMA_14" is null))
        ) or snapshotted_data."SMA_30" != source_data."SMA_30"
        or
        (
            ((snapshotted_data."SMA_30" is null) and not (source_data."SMA_30" is null))
            or
            ((not snapshotted_data."SMA_30" is null) and (source_data."SMA_30" is null))
        ) or snapshotted_data."RSI_14" != source_data."RSI_14"
        or
        (
            ((snapshotted_data."RSI_14" is null) and not (source_data."RSI_14" is null))
            or
            ((not snapshotted_data."RSI_14" is null) and (source_data."RSI_14" is null))
        ) or snapshotted_data."MOMENTUM_7D" != source_data."MOMENTUM_7D"
        or
        (
            ((snapshotted_data."MOMENTUM_7D" is null) and not (source_data."MOMENTUM_7D" is null))
            or
            ((not snapshotted_data."MOMENTUM_7D" is null) and (source_data."MOMENTUM_7D" is null))
        ))
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:54:18.900847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:54:18.905744 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:18.906601 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
[0m06:54:19.011384 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.0 seconds
[0m06:54:19.018404 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:19.019389 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
[0m06:54:19.107163 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.0 seconds
[0m06:54:19.114677 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:19.115539 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
[0m06:54:19.210781 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.0 seconds
[0m06:54:19.218391 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:19.219778 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
[0m06:54:19.337322 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.0 seconds
[0m06:54:19.348384 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:19.349235 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
[0m06:54:19.479351 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.0 seconds
[0m06:54:19.493210 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:19.496938 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:19.497714 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
BEGIN
[0m06:54:19.597144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:54:19.598006 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:19.598872 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
merge into "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAP_ID", "SYMBOL", "DT", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "SMA_7", "SMA_14", "SMA_30", "RSI_14", "MOMENTUM_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAP_ID", "SYMBOL", "DT", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "SMA_7", "SMA_14", "SMA_30", "RSI_14", "MOMENTUM_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:54:20.445527 [debug] [Thread-1 (]: SQL status: SUCCESS 88 in 1.0 seconds
[0m06:54:20.446550 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m06:54:20.447481 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
COMMIT
[0m06:54:20.807280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:54:20.850630 [debug] [Thread-1 (]: Timing info for snapshot.stock_transformations.fct_stock_abstract_snapshot (execute): 06:54:16.396334 => 06:54:20.850311
[0m06:54:20.851442 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: Close
[0m06:54:20.974873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84572f4-e3df-4d71-b82a-01a6d0628618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdacb0bbf0>]}
[0m06:54:20.976401 [info ] [Thread-1 (]: 1 of 1 OK snapshotted SNAPSHOT.fct_stock_abstract_snapshot ..................... [[32mSUCCESS 88[0m in 4.59s]
[0m06:54:20.977819 [debug] [Thread-1 (]: Finished running node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m06:54:20.981493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:20.982267 [debug] [MainThread]: Connection 'snapshot.stock_transformations.fct_stock_abstract_snapshot' was properly closed.
[0m06:54:20.982961 [info ] [MainThread]: 
[0m06:54:20.983784 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m06:54:20.985182 [debug] [MainThread]: Command end result
[0m06:54:20.998493 [info ] [MainThread]: 
[0m06:54:20.999326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:21.000067 [info ] [MainThread]: 
[0m06:54:21.000778 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:54:21.002115 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.669479, "process_user_time": 6.665334, "process_kernel_time": 0.565696, "process_mem_max_rss": "218560", "process_out_blocks": "1755", "process_in_blocks": "0"}
[0m06:54:21.002936 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:54:21.002764 after 8.67 seconds
[0m06:54:21.003789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcd17a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdad67d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdcae7b4d0>]}
[0m06:54:21.004598 [debug] [MainThread]: Flushing usage events
[0m23:50:30.923299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c7990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c7ed0>]}


============================== 23:50:30.941423 | 3bfc1cc2-2a0f-4d6c-aa02-60dbe013d5ca ==============================
[0m23:50:30.941423 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:50:30.942537 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'empty': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/oliverzheng/Desktop/Airflow/dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m23:50:30.948555 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m23:50:30.955276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.1412594, "process_in_blocks": "0", "process_kernel_time": 0.464156, "process_mem_max_rss": "96055296", "process_out_blocks": "0", "process_user_time": 1.651655}
[0m23:50:30.956068 [debug] [MainThread]: Command `dbt run` failed at 23:50:30.955933 after 0.14 seconds
[0m23:50:30.956682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d82c410>]}
[0m23:50:30.957539 [debug] [MainThread]: Flushing usage events
[0m23:50:31.485875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:53:51.401966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104841d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f7fd0>]}


============================== 23:53:51.414092 | e262d0bb-e365-46f1-8546-e7c82c97f726 ==============================
[0m23:53:51.414092 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:53:51.414910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'empty': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m23:53:53.884859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8d1890>]}
[0m23:53:53.958106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ca49b90>]}
[0m23:53:53.959495 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:53:54.154560 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:53:54.349089 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:53:54.349758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9b12d0>]}
[0m23:53:55.806153 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'FCT_STOCK_ABSTRACT' in the 'models' section of file 'models/schema.yml'
[0m23:53:56.015478 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_transformations.not_null_FCT_STOCK_ABSTRACT_sessionId.7daf011700' (models/schema.yml) depends on a node named 'FCT_STOCK_ABSTRACT' in package '' which was not found
[0m23:53:56.016099 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stock_transformations.unique_FCT_STOCK_ABSTRACT_sessionId.f6068ac72a' (models/schema.yml) depends on a node named 'FCT_STOCK_ABSTRACT' in package '' which was not found
[0m23:53:56.155677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d1c3b10>]}
[0m23:53:56.304013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:53:56.307769 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:53:56.334079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d2f5f90>]}
[0m23:53:56.334741 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 496 macros
[0m23:53:56.335362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d2b5350>]}
[0m23:53:56.337172 [info ] [MainThread]: 
[0m23:53:56.337934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:53:56.338680 [info ] [MainThread]: 
[0m23:53:56.339655 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:53:56.344851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m23:53:56.529813 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m23:53:56.530332 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m23:53:56.530758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:58.375454 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.845 seconds
[0m23:53:58.378440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_analytics)
[0m23:53:58.392536 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m23:53:58.393035 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m23:53:58.593234 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.200 seconds
[0m23:53:58.595967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now list_USER_DB_BOA_SNAPSHOT)
[0m23:53:58.600497 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m23:53:58.600954 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: show objects in USER_DB_BOA.SNAPSHOT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */;
[0m23:53:58.762763 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.161 seconds
[0m23:53:58.765504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c8fdbd0>]}
[0m23:53:58.769810 [debug] [Thread-1 (]: Began running node model.stock_transformations.stg_stock_prices
[0m23:53:58.770474 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_stock_prices ......................... [RUN]
[0m23:53:58.771083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now model.stock_transformations.stg_stock_prices)
[0m23:53:58.771599 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.stg_stock_prices
[0m23:53:58.779828 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.stg_stock_prices"
[0m23:53:58.781247 [debug] [Thread-1 (]: Began executing node model.stock_transformations.stg_stock_prices
[0m23:53:58.819164 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.stg_stock_prices"
[0m23:53:58.821954 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.stg_stock_prices"
[0m23:53:58.822814 [debug] [Thread-1 (]: On model.stock_transformations.stg_stock_prices: create or replace   view USER_DB_BOA.analytics.stg_stock_prices
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)            as symbol,
    cast(date as date)       as dt,
    cast(open as float)      as open,
    cast(high as float)      as high,
    cast(low  as float)      as low,
    cast(close as float)     as close,
    cast(volume as number)   as volume
  from USER_DB_BOA.RAW.stock_prices
  where symbol is not null
    and date   is not null
    and close  is not null
),
dedup as (
  select
    symbol, dt, open, high, low, close, volume,
    row_number() over (partition by symbol, dt order by dt desc) as rn
  from src
)
select
  symbol, dt, open, high, low, close, volume
from dedup
where rn = 1
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.stg_stock_prices"} */;
[0m23:53:59.091235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m23:53:59.119434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d057250>]}
[0m23:53:59.120482 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_stock_prices .................... [[32mSUCCESS 1[0m in 0.35s]
[0m23:53:59.121267 [debug] [Thread-1 (]: Finished running node model.stock_transformations.stg_stock_prices
[0m23:53:59.122273 [debug] [Thread-1 (]: Began running node model.stock_transformations.fct_stock_abstract
[0m23:53:59.122883 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.FCT_STOCK_ABSTRACT ...................... [RUN]
[0m23:53:59.123467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_transformations.stg_stock_prices, now model.stock_transformations.fct_stock_abstract)
[0m23:53:59.123908 [debug] [Thread-1 (]: Began compiling node model.stock_transformations.fct_stock_abstract
[0m23:53:59.127534 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_transformations.fct_stock_abstract"
[0m23:53:59.128760 [debug] [Thread-1 (]: Began executing node model.stock_transformations.fct_stock_abstract
[0m23:53:59.164217 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_transformations.fct_stock_abstract"
[0m23:53:59.167268 [debug] [Thread-1 (]: Using snowflake connection "model.stock_transformations.fct_stock_abstract"
[0m23:53:59.167952 [debug] [Thread-1 (]: On model.stock_transformations.fct_stock_abstract: create or replace transient table USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
    
    
    
    as (

with base as (
  select
    symbol,
    dt,
    open, high, low, close, volume,
    row_number() over (partition by symbol order by dt) as rn,
    lag(close) over (partition by symbol order by dt) as prev_close
  from USER_DB_BOA.analytics.stg_stock_prices
),
deltas as (
  select
    *,
    iff(prev_close is null, null, greatest(close - prev_close, 0)) as gain,
    iff(prev_close is null, null, greatest(prev_close - close, 0)) as loss
  from base
),
ma as (
  select
    *,
    avg(close) over (partition by symbol order by dt rows between 6 preceding and current row)  as sma_7,
    avg(close) over (partition by symbol order by dt rows between 13 preceding and current row) as sma_14,
    avg(close) over (partition by symbol order by dt rows between 29 preceding and current row) as sma_30,
    lag(close, 7) over (partition by symbol order by dt) as close_7
  from deltas
),
rsi as (
  select
    *,
    avg(gain) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_gain_14,
    avg(loss) over (partition by symbol order by dt rows between 13 preceding and current row) as avg_loss_14
  from ma
)
select
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  case
    when avg_loss_14 = 0 then 100
    when avg_gain_14 = 0 then 0
    when avg_gain_14 is null or avg_loss_14 is null then null
    else 100 - 100 / (1 + (avg_gain_14 / avg_loss_14))
  end as rsi_14,
  iff(close_7 is null, null, (close / nullif(close_7, 0)) - 1) as momentum_7d
from rsi
qualify rn > 30
order by symbol, dt
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "model.stock_transformations.fct_stock_abstract"} */;
[0m23:54:00.774317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.606 seconds
[0m23:54:00.777364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e262d0bb-e365-46f1-8546-e7c82c97f726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13df20450>]}
[0m23:54:00.778160 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.FCT_STOCK_ABSTRACT ................. [[32mSUCCESS 1[0m in 1.65s]
[0m23:54:00.778854 [debug] [Thread-1 (]: Finished running node model.stock_transformations.fct_stock_abstract
[0m23:54:00.780508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:00.780940 [debug] [MainThread]: Connection 'model.stock_transformations.fct_stock_abstract' was left open.
[0m23:54:00.781321 [debug] [MainThread]: On model.stock_transformations.fct_stock_abstract: Close
[0m23:54:00.914939 [info ] [MainThread]: 
[0m23:54:00.915604 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m23:54:00.916735 [debug] [MainThread]: Command end result
[0m23:54:00.942824 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:54:00.944794 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:54:00.951651 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:54:00.952226 [info ] [MainThread]: 
[0m23:54:00.952720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:00.953124 [info ] [MainThread]: 
[0m23:54:00.954125 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:54:00.961959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.647773, "process_in_blocks": "0", "process_kernel_time": 1.401506, "process_mem_max_rss": "207822848", "process_out_blocks": "0", "process_user_time": 6.134721}
[0m23:54:00.962790 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:00.962646 after 9.65 seconds
[0m23:54:00.963428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5f6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c563410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c574510>]}
[0m23:54:00.964397 [debug] [MainThread]: Flushing usage events
[0m23:54:01.493106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:56:43.354195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d193610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d20bf90>]}


============================== 23:56:43.367214 | ab159808-2483-4761-a621-9555d1ebcdd7 ==============================
[0m23:56:43.367214 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:56:43.368040 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False', 'empty': 'None', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt test', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'profiles_dir': '.', 'target_path': 'None', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs'}
[0m23:56:46.109280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab159808-2483-4761-a621-9555d1ebcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ba550>]}
[0m23:56:46.197963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab159808-2483-4761-a621-9555d1ebcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6ddbd0>]}
[0m23:56:46.199607 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:56:46.412260 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:56:46.635479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:56:46.636096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:56:46.713210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab159808-2483-4761-a621-9555d1ebcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1399d0390>]}
[0m23:56:46.833088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:56:46.835908 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:56:46.961933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab159808-2483-4761-a621-9555d1ebcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139744a50>]}
[0m23:56:46.962836 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 496 macros
[0m23:56:46.963838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab159808-2483-4761-a621-9555d1ebcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139803b10>]}
[0m23:56:46.966568 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:56:46.969071 [debug] [MainThread]: Command end result
[0m23:56:46.999945 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:56:47.003844 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:56:47.008096 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:56:47.014737 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.7632005, "process_in_blocks": "0", "process_kernel_time": 1.128853, "process_mem_max_rss": "169746432", "process_out_blocks": "0", "process_user_time": 3.879849}
[0m23:56:47.015591 [debug] [MainThread]: Command `dbt test` succeeded at 23:56:47.015430 after 3.76 seconds
[0m23:56:47.016364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109297f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109297410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8af50>]}
[0m23:56:47.016874 [debug] [MainThread]: Flushing usage events
[0m23:56:47.611251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:30.957520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f77b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f79bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f79bf90>]}


============================== 23:57:30.966645 | d6d76508-d70c-4ac0-bae0-5a38ed5e730f ==============================
[0m23:57:30.966645 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:57:30.967532 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt test', 'profiles_dir': '.', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True'}
[0m23:57:30.971488 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'stock_transformations'
[0m23:57:30.975233 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.10876283, "process_in_blocks": "0", "process_kernel_time": 0.384207, "process_mem_max_rss": "95629312", "process_out_blocks": "0", "process_user_time": 1.685045}
[0m23:57:30.976155 [debug] [MainThread]: Command `dbt test` failed at 23:57:30.975960 after 0.11 seconds
[0m23:57:30.976759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7591d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b886710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f79c290>]}
[0m23:57:30.977311 [debug] [MainThread]: Flushing usage events
[0m23:57:31.457279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:05.307857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113935190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113937050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139bd1d0>]}


============================== 23:58:05.316640 | cb6b584c-b01b-4ae9-93ed-9463f26bb2ae ==============================
[0m23:58:05.316640 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:58:05.317408 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'printer_width': '80', 'debug': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error': 'None', 'empty': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'introspect': 'True'}
[0m23:58:07.328332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb6b584c-b01b-4ae9-93ed-9463f26bb2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139e21d0>]}
[0m23:58:07.405617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb6b584c-b01b-4ae9-93ed-9463f26bb2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fd9d690>]}
[0m23:58:07.407262 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:58:07.598230 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:58:07.796607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:07.797134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:07.857852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb6b584c-b01b-4ae9-93ed-9463f26bb2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14021e990>]}
[0m23:58:07.966883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:58:07.969970 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:58:08.093433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb6b584c-b01b-4ae9-93ed-9463f26bb2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13feee710>]}
[0m23:58:08.094329 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 496 macros
[0m23:58:08.094896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6b584c-b01b-4ae9-93ed-9463f26bb2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14016e290>]}
[0m23:58:08.096857 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:58:08.099363 [debug] [MainThread]: Command end result
[0m23:58:08.128946 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m23:58:08.130794 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m23:58:08.135931 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m23:58:08.143466 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9242268, "process_in_blocks": "0", "process_kernel_time": 1.04802, "process_mem_max_rss": "178585600", "process_out_blocks": "0", "process_user_time": 3.825817}
[0m23:58:08.144254 [debug] [MainThread]: Command `dbt test` succeeded at 23:58:08.144126 after 2.93 seconds
[0m23:58:08.144759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11399ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11399f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11393bd90>]}
[0m23:58:08.145240 [debug] [MainThread]: Flushing usage events
[0m23:58:08.724540 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:47.464408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106291150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ffe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ffad0>]}


============================== 00:03:47.481277 | d5510a72-42b8-40fe-8d63-8a41c8abdd44 ==============================
[0m00:03:47.481277 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m00:03:47.482296 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt test', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '.', 'debug': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'quiet': 'False'}
[0m00:03:49.629508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5510a72-42b8-40fe-8d63-8a41c8abdd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb0790>]}
[0m00:03:49.698155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5510a72-42b8-40fe-8d63-8a41c8abdd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a2ad0>]}
[0m00:03:49.699729 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m00:03:49.881870 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m00:03:50.101130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:03:50.102022 [debug] [MainThread]: Partial parsing: updated file: stock_transformations://models/schema.yml
[0m00:03:50.476171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5510a72-42b8-40fe-8d63-8a41c8abdd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397e5d0>]}
[0m00:03:50.583070 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m00:03:50.586281 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m00:03:50.632586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5510a72-42b8-40fe-8d63-8a41c8abdd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f774d0>]}
[0m00:03:50.633391 [info ] [MainThread]: Found 2 models, 1 snapshot, 2 data tests, 1 source, 496 macros
[0m00:03:50.633874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5510a72-42b8-40fe-8d63-8a41c8abdd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13280c610>]}
[0m00:03:50.635619 [info ] [MainThread]: 
[0m00:03:50.636095 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:50.636459 [info ] [MainThread]: 
[0m00:03:50.636999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:03:50.641544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m00:03:50.839359 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m00:03:50.840050 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m00:03:50.840724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:52.423781 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.583 seconds
[0m00:03:52.428827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now list_USER_DB_BOA_SNAPSHOT)
[0m00:03:52.435929 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m00:03:52.436508 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: show objects in USER_DB_BOA.SNAPSHOT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */;
[0m00:03:52.618301 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.181 seconds
[0m00:03:52.622901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5510a72-42b8-40fe-8d63-8a41c8abdd44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f92550>]}
[0m00:03:52.628345 [debug] [Thread-1 (]: Began running node test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495
[0m00:03:52.629141 [info ] [Thread-1 (]: 1 of 2 START test not_null_fct_stock_abstract_sessionId ........................ [RUN]
[0m00:03:52.629946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495)
[0m00:03:52.630583 [debug] [Thread-1 (]: Began compiling node test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495
[0m00:03:52.650605 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495"
[0m00:03:52.652363 [debug] [Thread-1 (]: Began executing node test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495
[0m00:03:52.680817 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495"
[0m00:03:52.682148 [debug] [Thread-1 (]: Using snowflake connection "test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495"
[0m00:03:52.682607 [debug] [Thread-1 (]: On test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sessionId
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
where sessionId is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495"} */
[0m00:03:52.887632 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c09f83-0307-1fc0-000f-c0df0097b6be
[0m00:03:52.888218 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 7
invalid identifier 'SESSIONID'
[0m00:03:52.893502 [debug] [Thread-1 (]: Database Error in test not_null_fct_stock_abstract_sessionId (models/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'SESSIONID'
  compiled code at target/run/stock_transformations/models/schema.yml/not_null_fct_stock_abstract_sessionId.sql
[0m00:03:52.894314 [error] [Thread-1 (]: 1 of 2 ERROR not_null_fct_stock_abstract_sessionId ............................. [[31mERROR[0m in 0.26s]
[0m00:03:52.895073 [debug] [Thread-1 (]: Finished running node test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495
[0m00:03:52.895590 [debug] [Thread-1 (]: Began running node test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42
[0m00:03:52.896186 [debug] [Thread-4 (]: Marking all children of 'test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_stock_abstract_sessionId (models/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'SESSIONID'
  compiled code at target/run/stock_transformations/models/schema.yml/not_null_fct_stock_abstract_sessionId.sql.
[0m00:03:52.896801 [info ] [Thread-1 (]: 2 of 2 START test unique_fct_stock_abstract_sessionId .......................... [RUN]
[0m00:03:52.897595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_transformations.not_null_fct_stock_abstract_sessionId.839cb65495, now test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42)
[0m00:03:52.898091 [debug] [Thread-1 (]: Began compiling node test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42
[0m00:03:52.906921 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42"
[0m00:03:52.908007 [debug] [Thread-1 (]: Began executing node test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42
[0m00:03:52.911651 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42"
[0m00:03:52.912975 [debug] [Thread-1 (]: Using snowflake connection "test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42"
[0m00:03:52.913537 [debug] [Thread-1 (]: On test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
where sessionId is not null
group by sessionId
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42"} */
[0m00:03:53.036557 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c09f83-0307-2011-000f-c0df0098016a
[0m00:03:53.037167 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 4
invalid identifier 'SESSIONID'
[0m00:03:53.040844 [debug] [Thread-1 (]: Database Error in test unique_fct_stock_abstract_sessionId (models/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'SESSIONID'
  compiled code at target/run/stock_transformations/models/schema.yml/unique_fct_stock_abstract_sessionId.sql
[0m00:03:53.041444 [error] [Thread-1 (]: 2 of 2 ERROR unique_fct_stock_abstract_sessionId ............................... [[31mERROR[0m in 0.14s]
[0m00:03:53.042337 [debug] [Thread-1 (]: Finished running node test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42
[0m00:03:53.043117 [debug] [Thread-4 (]: Marking all children of 'test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42' to be skipped because of status 'error'.  Reason: Database Error in test unique_fct_stock_abstract_sessionId (models/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'SESSIONID'
  compiled code at target/run/stock_transformations/models/schema.yml/unique_fct_stock_abstract_sessionId.sql.
[0m00:03:53.044993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:53.045493 [debug] [MainThread]: Connection 'test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42' was left open.
[0m00:03:53.045921 [debug] [MainThread]: On test.stock_transformations.unique_fct_stock_abstract_sessionId.d45dd3df42: Close
[0m00:03:53.193788 [info ] [MainThread]: 
[0m00:03:53.194873 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m00:03:53.196225 [debug] [MainThread]: Command end result
[0m00:03:53.221953 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m00:03:53.224115 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m00:03:53.236352 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m00:03:53.237240 [info ] [MainThread]: 
[0m00:03:53.238660 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:03:53.239934 [info ] [MainThread]: 
[0m00:03:53.240706 [error] [MainThread]: [31mFailure in test not_null_fct_stock_abstract_sessionId (models/schema.yml)[0m
[0m00:03:53.241312 [error] [MainThread]:   Database Error in test not_null_fct_stock_abstract_sessionId (models/schema.yml)
  000904 (42000): SQL compilation error: error line 14 at position 7
  invalid identifier 'SESSIONID'
  compiled code at target/run/stock_transformations/models/schema.yml/not_null_fct_stock_abstract_sessionId.sql
[0m00:03:53.242159 [info ] [MainThread]: 
[0m00:03:53.243429 [info ] [MainThread]:   compiled code at target/compiled/stock_transformations/models/schema.yml/not_null_fct_stock_abstract_sessionId.sql
[0m00:03:53.244131 [info ] [MainThread]: 
[0m00:03:53.244942 [error] [MainThread]: [31mFailure in test unique_fct_stock_abstract_sessionId (models/schema.yml)[0m
[0m00:03:53.245523 [error] [MainThread]:   Database Error in test unique_fct_stock_abstract_sessionId (models/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 4
  invalid identifier 'SESSIONID'
  compiled code at target/run/stock_transformations/models/schema.yml/unique_fct_stock_abstract_sessionId.sql
[0m00:03:53.246091 [info ] [MainThread]: 
[0m00:03:53.246957 [info ] [MainThread]:   compiled code at target/compiled/stock_transformations/models/schema.yml/unique_fct_stock_abstract_sessionId.sql
[0m00:03:53.247796 [info ] [MainThread]: 
[0m00:03:53.248599 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m00:03:53.256732 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.8830323, "process_in_blocks": "0", "process_kernel_time": 1.305966, "process_mem_max_rss": "202326016", "process_out_blocks": "0", "process_user_time": 4.543141}
[0m00:03:53.257842 [debug] [MainThread]: Command `dbt test` failed at 00:03:53.257660 after 5.88 seconds
[0m00:03:53.258859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106314bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106314b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102374150>]}
[0m00:03:53.259746 [debug] [MainThread]: Flushing usage events
[0m00:03:53.730010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:08:19.694650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147a7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d3e50>]}


============================== 00:08:19.711915 | a412d238-860e-44bc-afe8-6706b791e35c ==============================
[0m00:08:19.711915 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m00:08:19.712831 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'profiles_dir': '.', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'empty': 'None', 'target_path': 'None', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'warn_error': 'None'}
[0m00:08:21.927460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a412d238-860e-44bc-afe8-6706b791e35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147f4490>]}
[0m00:08:21.994608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a412d238-860e-44bc-afe8-6706b791e35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c72a90>]}
[0m00:08:21.996227 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m00:08:22.178210 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m00:08:22.386607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:08:22.387652 [debug] [MainThread]: Partial parsing: updated file: stock_transformations://models/schema.yml
[0m00:08:22.968224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a412d238-860e-44bc-afe8-6706b791e35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1413b2610>]}
[0m00:08:23.075638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m00:08:23.078388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m00:08:23.113777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a412d238-860e-44bc-afe8-6706b791e35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1415da1d0>]}
[0m00:08:23.114521 [info ] [MainThread]: Found 2 models, 1 snapshot, 4 data tests, 1 source, 496 macros
[0m00:08:23.114943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a412d238-860e-44bc-afe8-6706b791e35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14149e190>]}
[0m00:08:23.116596 [info ] [MainThread]: 
[0m00:08:23.117006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:23.117389 [info ] [MainThread]: 
[0m00:08:23.117922 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:08:23.122973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m00:08:23.294784 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m00:08:23.295313 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m00:08:23.295957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:25.430323 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 2.134 seconds
[0m00:08:25.433276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now list_USER_DB_BOA_SNAPSHOT)
[0m00:08:25.440286 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m00:08:25.440797 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: show objects in USER_DB_BOA.SNAPSHOT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */;
[0m00:08:25.572101 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.131 seconds
[0m00:08:25.576703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a412d238-860e-44bc-afe8-6706b791e35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11479b0d0>]}
[0m00:08:25.581866 [debug] [Thread-1 (]: Began running node test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2
[0m00:08:25.582669 [info ] [Thread-1 (]: 1 of 4 START test not_null_fct_stock_abstract_dt ............................... [RUN]
[0m00:08:25.583477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2)
[0m00:08:25.584124 [debug] [Thread-1 (]: Began compiling node test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2
[0m00:08:25.603931 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2"
[0m00:08:25.604916 [debug] [Thread-1 (]: Began executing node test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2
[0m00:08:25.632654 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2"
[0m00:08:25.633926 [debug] [Thread-1 (]: Using snowflake connection "test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2"
[0m00:08:25.634430 [debug] [Thread-1 (]: On test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dt
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
where dt is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2"} */
[0m00:08:26.039312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m00:08:26.051530 [info ] [Thread-1 (]: 1 of 4 PASS not_null_fct_stock_abstract_dt ..................................... [[32mPASS[0m in 0.47s]
[0m00:08:26.052508 [debug] [Thread-1 (]: Finished running node test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2
[0m00:08:26.053135 [debug] [Thread-1 (]: Began running node test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d
[0m00:08:26.053779 [info ] [Thread-1 (]: 2 of 4 START test not_null_fct_stock_abstract_symbol ........................... [RUN]
[0m00:08:26.054494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_transformations.not_null_fct_stock_abstract_dt.ce9874faf2, now test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d)
[0m00:08:26.055061 [debug] [Thread-1 (]: Began compiling node test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d
[0m00:08:26.060627 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d"
[0m00:08:26.061633 [debug] [Thread-1 (]: Began executing node test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d
[0m00:08:26.066714 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d"
[0m00:08:26.068331 [debug] [Thread-1 (]: Using snowflake connection "test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d"
[0m00:08:26.069104 [debug] [Thread-1 (]: On test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d"} */
[0m00:08:26.447871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m00:08:26.451463 [info ] [Thread-1 (]: 2 of 4 PASS not_null_fct_stock_abstract_symbol ................................. [[32mPASS[0m in 0.40s]
[0m00:08:26.452963 [debug] [Thread-1 (]: Finished running node test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d
[0m00:08:26.453956 [debug] [Thread-1 (]: Began running node test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79
[0m00:08:26.454785 [info ] [Thread-1 (]: 3 of 4 START test not_null_stg_stock_prices_dt ................................. [RUN]
[0m00:08:26.455839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_transformations.not_null_fct_stock_abstract_symbol.0cc1e3e91d, now test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79)
[0m00:08:26.456754 [debug] [Thread-1 (]: Began compiling node test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79
[0m00:08:26.464454 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79"
[0m00:08:26.466404 [debug] [Thread-1 (]: Began executing node test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79
[0m00:08:26.472309 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79"
[0m00:08:26.475250 [debug] [Thread-1 (]: Using snowflake connection "test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79"
[0m00:08:26.517142 [debug] [Thread-1 (]: On test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dt
from USER_DB_BOA.analytics.stg_stock_prices
where dt is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79"} */
[0m00:08:26.977566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m00:08:26.981705 [info ] [Thread-1 (]: 3 of 4 PASS not_null_stg_stock_prices_dt ....................................... [[32mPASS[0m in 0.53s]
[0m00:08:26.982885 [debug] [Thread-1 (]: Finished running node test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79
[0m00:08:26.983739 [debug] [Thread-1 (]: Began running node test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb
[0m00:08:26.984518 [info ] [Thread-1 (]: 4 of 4 START test not_null_stg_stock_prices_symbol ............................. [RUN]
[0m00:08:26.985271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_transformations.not_null_stg_stock_prices_dt.3079d13e79, now test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb)
[0m00:08:26.985910 [debug] [Thread-1 (]: Began compiling node test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb
[0m00:08:26.991811 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb"
[0m00:08:26.992827 [debug] [Thread-1 (]: Began executing node test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb
[0m00:08:26.997934 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb"
[0m00:08:26.999200 [debug] [Thread-1 (]: Using snowflake connection "test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb"
[0m00:08:26.999740 [debug] [Thread-1 (]: On test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_BOA.analytics.stg_stock_prices
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb"} */
[0m00:08:27.497137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m00:08:27.500398 [info ] [Thread-1 (]: 4 of 4 PASS not_null_stg_stock_prices_symbol ................................... [[32mPASS[0m in 0.52s]
[0m00:08:27.501536 [debug] [Thread-1 (]: Finished running node test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb
[0m00:08:27.503346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:27.503912 [debug] [MainThread]: Connection 'test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb' was left open.
[0m00:08:27.504425 [debug] [MainThread]: On test.stock_transformations.not_null_stg_stock_prices_symbol.c5ad3c0efb: Close
[0m00:08:27.683426 [info ] [MainThread]: 
[0m00:08:27.684536 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m00:08:27.686726 [debug] [MainThread]: Command end result
[0m00:08:27.716114 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m00:08:27.718097 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m00:08:27.727307 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m00:08:27.728039 [info ] [MainThread]: 
[0m00:08:27.728797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:08:27.729573 [info ] [MainThread]: 
[0m00:08:27.730168 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m00:08:27.736078 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.128798, "process_in_blocks": "0", "process_kernel_time": 1.269663, "process_mem_max_rss": "205479936", "process_out_blocks": "0", "process_user_time": 4.77916}
[0m00:08:27.736870 [debug] [MainThread]: Command `dbt test` succeeded at 00:08:27.736683 after 8.13 seconds
[0m00:08:27.737491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108433d0>]}
[0m00:08:27.738158 [debug] [MainThread]: Flushing usage events
[0m00:08:28.212454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:09:09.341883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109599310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109613e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109613e50>]}


============================== 00:09:09.350868 | 12c14749-d0cb-4cf0-9b67-b07c46f16d47 ==============================
[0m00:09:09.350868 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m00:09:09.351655 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'log_cache_events': 'False', 'log_path': '/Users/oliverzheng/Desktop/Airflow/dbt/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m00:09:11.481268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12c14749-d0cb-4cf0-9b67-b07c46f16d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b07b90>]}
[0m00:09:11.554471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12c14749-d0cb-4cf0-9b67-b07c46f16d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b69750>]}
[0m00:09:11.556532 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m00:09:11.739943 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m00:09:11.957831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:09:11.958354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:09:12.026785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12c14749-d0cb-4cf0-9b67-b07c46f16d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f09390>]}
[0m00:09:12.141001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m00:09:12.144049 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m00:09:12.256810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12c14749-d0cb-4cf0-9b67-b07c46f16d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f30cd0>]}
[0m00:09:12.257747 [info ] [MainThread]: Found 2 models, 1 snapshot, 4 data tests, 1 source, 496 macros
[0m00:09:12.258355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c14749-d0cb-4cf0-9b67-b07c46f16d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587d050>]}
[0m00:09:12.260463 [info ] [MainThread]: 
[0m00:09:12.261053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:09:12.261547 [info ] [MainThread]: 
[0m00:09:12.262300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:09:12.263473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m00:09:12.389798 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m00:09:12.390371 [debug] [ThreadPool]: On list_USER_DB_BOA: show terse schemas in database USER_DB_BOA
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
[0m00:09:12.390821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:13.475006 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.084 seconds
[0m00:09:13.485757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now list_USER_DB_BOA_SNAPSHOT)
[0m00:09:13.502444 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_SNAPSHOT"
[0m00:09:13.503035 [debug] [ThreadPool]: On list_USER_DB_BOA_SNAPSHOT: show objects in USER_DB_BOA.SNAPSHOT
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_SNAPSHOT"} */;
[0m00:09:13.658373 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.155 seconds
[0m00:09:13.661966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_SNAPSHOT, now list_USER_DB_BOA_analytics)
[0m00:09:13.666303 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m00:09:13.666805 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: show objects in USER_DB_BOA.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */;
[0m00:09:14.175525 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.508 seconds
[0m00:09:14.182727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c14749-d0cb-4cf0-9b67-b07c46f16d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1362e98d0>]}
[0m00:09:14.187358 [debug] [Thread-1 (]: Began running node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m00:09:14.188336 [info ] [Thread-1 (]: 1 of 1 START snapshot SNAPSHOT.fct_stock_abstract_snapshot ..................... [RUN]
[0m00:09:14.189147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now snapshot.stock_transformations.fct_stock_abstract_snapshot)
[0m00:09:14.189810 [debug] [Thread-1 (]: Began compiling node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m00:09:14.200697 [debug] [Thread-1 (]: Began executing node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m00:09:14.267712 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:14.268301 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: select * from (
        select open, high, low, close, volume, sma_7, sma_14, sma_30, rsi_14, momentum_7d from (
                

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT
            ) subq
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:14.678441 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.409 seconds
[0m00:09:14.693419 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:14.695471 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:14.892498 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.195 seconds
[0m00:09:14.906166 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:14.906869 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:15.094160 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.187 seconds
[0m00:09:15.164537 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:15.165510 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: create or replace temporary table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT

    ),

    snapshotted_data as (

        select *, 
    
        snap_id as dbt_unique_key
    

        from "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        snap_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."SMA_7" != source_data."SMA_7"
        or
        (
            ((snapshotted_data."SMA_7" is null) and not (source_data."SMA_7" is null))
            or
            ((not snapshotted_data."SMA_7" is null) and (source_data."SMA_7" is null))
        ) or snapshotted_data."SMA_14" != source_data."SMA_14"
        or
        (
            ((snapshotted_data."SMA_14" is null) and not (source_data."SMA_14" is null))
            or
            ((not snapshotted_data."SMA_14" is null) and (source_data."SMA_14" is null))
        ) or snapshotted_data."SMA_30" != source_data."SMA_30"
        or
        (
            ((snapshotted_data."SMA_30" is null) and not (source_data."SMA_30" is null))
            or
            ((not snapshotted_data."SMA_30" is null) and (source_data."SMA_30" is null))
        ) or snapshotted_data."RSI_14" != source_data."RSI_14"
        or
        (
            ((snapshotted_data."RSI_14" is null) and not (source_data."RSI_14" is null))
            or
            ((not snapshotted_data."RSI_14" is null) and (source_data."RSI_14" is null))
        ) or snapshotted_data."MOMENTUM_7D" != source_data."MOMENTUM_7D"
        or
        (
            ((snapshotted_data."MOMENTUM_7D" is null) and not (source_data."MOMENTUM_7D" is null))
            or
            ((not snapshotted_data."MOMENTUM_7D" is null) and (source_data."MOMENTUM_7D" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."SMA_7" != source_data."SMA_7"
        or
        (
            ((snapshotted_data."SMA_7" is null) and not (source_data."SMA_7" is null))
            or
            ((not snapshotted_data."SMA_7" is null) and (source_data."SMA_7" is null))
        ) or snapshotted_data."SMA_14" != source_data."SMA_14"
        or
        (
            ((snapshotted_data."SMA_14" is null) and not (source_data."SMA_14" is null))
            or
            ((not snapshotted_data."SMA_14" is null) and (source_data."SMA_14" is null))
        ) or snapshotted_data."SMA_30" != source_data."SMA_30"
        or
        (
            ((snapshotted_data."SMA_30" is null) and not (source_data."SMA_30" is null))
            or
            ((not snapshotted_data."SMA_30" is null) and (source_data."SMA_30" is null))
        ) or snapshotted_data."RSI_14" != source_data."RSI_14"
        or
        (
            ((snapshotted_data."RSI_14" is null) and not (source_data."RSI_14" is null))
            or
            ((not snapshotted_data."RSI_14" is null) and (source_data."RSI_14" is null))
        ) or snapshotted_data."MOMENTUM_7D" != source_data."MOMENTUM_7D"
        or
        (
            ((snapshotted_data."MOMENTUM_7D" is null) and not (source_data."MOMENTUM_7D" is null))
            or
            ((not snapshotted_data."MOMENTUM_7D" is null) and (source_data."MOMENTUM_7D" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */;
[0m00:09:16.535447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.369 seconds
[0m00:09:16.541528 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:16.542356 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:16.644768 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.102 seconds
[0m00:09:16.650838 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:16.651419 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:16.810071 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.158 seconds
[0m00:09:16.817816 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:16.818715 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:16.938762 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.119 seconds
[0m00:09:16.945566 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:16.946268 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:17.184130 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.237 seconds
[0m00:09:17.196448 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:17.197124 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: describe table "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:17.303114 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.105 seconds
[0m00:09:17.336095 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:17.337047 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: select * from (
        
    
    with snapshot_query as (

        

select
  hash(symbol, dt) as snap_id,
  symbol,
  dt,
  open, high, low, close, volume,
  sma_7, sma_14, sma_30,
  rsi_14,
  momentum_7d
from USER_DB_BOA.analytics.FCT_STOCK_ABSTRACT

    ),

    snapshotted_data as (

        select *, 
    
        snap_id as dbt_unique_key
    

        from "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        snap_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(snap_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        snap_id as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        snap_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."SMA_7" != source_data."SMA_7"
        or
        (
            ((snapshotted_data."SMA_7" is null) and not (source_data."SMA_7" is null))
            or
            ((not snapshotted_data."SMA_7" is null) and (source_data."SMA_7" is null))
        ) or snapshotted_data."SMA_14" != source_data."SMA_14"
        or
        (
            ((snapshotted_data."SMA_14" is null) and not (source_data."SMA_14" is null))
            or
            ((not snapshotted_data."SMA_14" is null) and (source_data."SMA_14" is null))
        ) or snapshotted_data."SMA_30" != source_data."SMA_30"
        or
        (
            ((snapshotted_data."SMA_30" is null) and not (source_data."SMA_30" is null))
            or
            ((not snapshotted_data."SMA_30" is null) and (source_data."SMA_30" is null))
        ) or snapshotted_data."RSI_14" != source_data."RSI_14"
        or
        (
            ((snapshotted_data."RSI_14" is null) and not (source_data."RSI_14" is null))
            or
            ((not snapshotted_data."RSI_14" is null) and (source_data."RSI_14" is null))
        ) or snapshotted_data."MOMENTUM_7D" != source_data."MOMENTUM_7D"
        or
        (
            ((snapshotted_data."MOMENTUM_7D" is null) and not (source_data."MOMENTUM_7D" is null))
            or
            ((not snapshotted_data."MOMENTUM_7D" is null) and (source_data."MOMENTUM_7D" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."OPEN" != source_data."OPEN"
        or
        (
            ((snapshotted_data."OPEN" is null) and not (source_data."OPEN" is null))
            or
            ((not snapshotted_data."OPEN" is null) and (source_data."OPEN" is null))
        ) or snapshotted_data."HIGH" != source_data."HIGH"
        or
        (
            ((snapshotted_data."HIGH" is null) and not (source_data."HIGH" is null))
            or
            ((not snapshotted_data."HIGH" is null) and (source_data."HIGH" is null))
        ) or snapshotted_data."LOW" != source_data."LOW"
        or
        (
            ((snapshotted_data."LOW" is null) and not (source_data."LOW" is null))
            or
            ((not snapshotted_data."LOW" is null) and (source_data."LOW" is null))
        ) or snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ) or snapshotted_data."SMA_7" != source_data."SMA_7"
        or
        (
            ((snapshotted_data."SMA_7" is null) and not (source_data."SMA_7" is null))
            or
            ((not snapshotted_data."SMA_7" is null) and (source_data."SMA_7" is null))
        ) or snapshotted_data."SMA_14" != source_data."SMA_14"
        or
        (
            ((snapshotted_data."SMA_14" is null) and not (source_data."SMA_14" is null))
            or
            ((not snapshotted_data."SMA_14" is null) and (source_data."SMA_14" is null))
        ) or snapshotted_data."SMA_30" != source_data."SMA_30"
        or
        (
            ((snapshotted_data."SMA_30" is null) and not (source_data."SMA_30" is null))
            or
            ((not snapshotted_data."SMA_30" is null) and (source_data."SMA_30" is null))
        ) or snapshotted_data."RSI_14" != source_data."RSI_14"
        or
        (
            ((snapshotted_data."RSI_14" is null) and not (source_data."RSI_14" is null))
            or
            ((not snapshotted_data."RSI_14" is null) and (source_data."RSI_14" is null))
        ) or snapshotted_data."MOMENTUM_7D" != source_data."MOMENTUM_7D"
        or
        (
            ((snapshotted_data."MOMENTUM_7D" is null) and not (source_data."MOMENTUM_7D" is null))
            or
            ((not snapshotted_data."MOMENTUM_7D" is null) and (source_data."MOMENTUM_7D" is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:17.960675 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.622 seconds
[0m00:09:17.967773 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:17.968491 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:18.073271 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.104 seconds
[0m00:09:18.074799 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:18.079842 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:18.080816 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:18.225005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m00:09:18.226265 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:18.227354 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: merge into "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_BOA"."SNAPSHOT"."FCT_STOCK_ABSTRACT_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SNAP_ID", "SYMBOL", "DT", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "SMA_7", "SMA_14", "SMA_30", "RSI_14", "MOMENTUM_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SNAP_ID", "SYMBOL", "DT", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "SMA_7", "SMA_14", "SMA_30", "RSI_14", "MOMENTUM_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */;
[0m00:09:19.094713 [debug] [Thread-1 (]: SQL status: SUCCESS 150 in 0.866 seconds
[0m00:09:19.096089 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_transformations.fct_stock_abstract_snapshot"
[0m00:09:19.097064 [debug] [Thread-1 (]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_transformations", "target_name": "dev", "node_id": "snapshot.stock_transformations.fct_stock_abstract_snapshot"} */
[0m00:09:19.492452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m00:09:19.523789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c14749-d0cb-4cf0-9b67-b07c46f16d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ca7410>]}
[0m00:09:19.525050 [info ] [Thread-1 (]: 1 of 1 OK snapshotted SNAPSHOT.fct_stock_abstract_snapshot ..................... [[32mSUCCESS 150[0m in 5.33s]
[0m00:09:19.525867 [debug] [Thread-1 (]: Finished running node snapshot.stock_transformations.fct_stock_abstract_snapshot
[0m00:09:19.527290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:09:19.527705 [debug] [MainThread]: Connection 'snapshot.stock_transformations.fct_stock_abstract_snapshot' was left open.
[0m00:09:19.528110 [debug] [MainThread]: On snapshot.stock_transformations.fct_stock_abstract_snapshot: Close
[0m00:09:19.680192 [info ] [MainThread]: 
[0m00:09:19.681065 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.42 seconds (7.42s).
[0m00:09:19.682396 [debug] [MainThread]: Command end result
[0m00:09:19.715069 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/manifest.json
[0m00:09:19.717376 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/oliverzheng/Desktop/Airflow/dbt/target/semantic_manifest.json
[0m00:09:19.726602 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/oliverzheng/Desktop/Airflow/dbt/target/run_results.json
[0m00:09:19.727162 [info ] [MainThread]: 
[0m00:09:19.728036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:09:19.728664 [info ] [MainThread]: 
[0m00:09:19.729285 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:09:19.735624 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.481577, "process_in_blocks": "0", "process_kernel_time": 1.205147, "process_mem_max_rss": "200867840", "process_out_blocks": "0", "process_user_time": 4.61821}
[0m00:09:19.736926 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:09:19.736413 after 10.48 seconds
[0m00:09:19.738297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109386e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105726550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105693f10>]}
[0m00:09:19.739489 [debug] [MainThread]: Flushing usage events
[0m00:09:20.150313 [debug] [MainThread]: An error was encountered while trying to flush usage events
